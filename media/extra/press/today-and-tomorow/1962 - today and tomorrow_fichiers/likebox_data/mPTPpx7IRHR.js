/*1344029612,176820662*/

if (window.CavalryLogger) { CavalryLogger.start_js(["1cz4J"]); }

__d("PromotedPostConstants",[],function(a,b,c,d,e,f){var g={SAVE:'boosted_post/save',CANCEL:'boosted_post/cancel',FLYOUT_SHOW:'promoted_post/flyout_show',FLYOUT_HIDE:'promoted_post/flyout_hide',CLOSE:'boosted_post/close',SET_BUDGET:'boosted_post/set_budget',STOP:'boosted_post/stop',RESUME:'boosted_post/resume',ACCOUNT_CHANGE:'boosted_post/account_change',FOC_CHANGE:'boosted_post/foc_change'};e.exports=g;});
__d("BoostedPostLogging",["EagleEye","AsyncRequest"],function(a,b,c,d,e,f){var g=b('EagleEye'),h=b('AsyncRequest'),i={log:function(j,k){k.event=j;g.log('roe',k);},logClickConversionTracking:function(j,k,l,m){var n={page_id:j};if(k)n.post_id=k;if(l)n.campaign_id=l;if(m)n.campaign_placement=m;new h('/ads/ajax/boosted/convtrack.php').setData(n).send();}};e.exports=i;});
__d("BoostedPostPostWidget",["event-extensions","Arbiter","ArbiterMixin","AsyncRequest","Class","CSS","DOM","BoostedPostLogging","PromotedPostConstants","copyProperties"],function(a,b,c,d,e,f){b('event-extensions');var g=b('Arbiter'),h=b('ArbiterMixin'),i=b('AsyncRequest'),j=b('Class'),k=b('CSS'),l=b('DOM'),m=b('BoostedPostLogging'),n=b('PromotedPostConstants'),o=b('copyProperties'),p={},q=0;function r(s,t,u,v,w,x,y,z,aa,ba){this._popover=s;this._popoverButton=t;this._loadingMenu=u;this._pageId=v;this._postId=w;this._isBoosted=x;this._campaignId=y;this._campaignPlacement=z;this._createLogWaitingForFlyout=false;this._instanceId=q++;p[this._instanceId]=this;this._flyout=null;this._statusThrobber=null;this._autoOpenPopover=aa;this._additionalLoggingData=ba;this._initialize();}r.setFlyout=function(s,t,u){p[s].setFlyout(t,u);};o(r.prototype,h,{_fetched:false,_mouseoverListener:null,_firstClickListener:null,_initialize:function(){this.loggingData={page_id:this._pageId,post_id:this._postId};this._mouseoverListener=Event.listen(this._popoverButton,'mouseover',this._fetchFlyout.bind(this));this._firstClickListener=Event.listen(this._popoverButton,'click',this._onFirstClick.bind(this));if(!this._autoOpenPopover)this._popover.subscribe('show',function(){if(!this._flyout&&!this._isBoosted){this._createLogWaitingForFlyout=true;return;}this._logOnFlyoutOpen();}.bind(this));if(this._autoOpenPopover){this._popoverButton.click();this.loggingData.campaign_id=this._campaignId;this.loggingData.budget_remaining=this._additionalLoggingData.budget_remaining;m.log('clicked_after_budget_notification',this.loggingData);}},_createListener:function(s,t){this._statusThrobber&&k.show(this._statusThrobber);this._flyout.setButtonsEnabled(false);this.loggingData.budget=t.formData.boosted_post_budget;m.log('timeline_create_save',this.loggingData);new i('/ads/ajax/boosted/edit.php').setData({status:true,account_id:t.formData.boosted_post_account_id,budget:t.formData.boosted_post_budget,currency:t.formData.boosted_post_currency,foc_enabled:t.formData.boosted_post_enable_foc,page_id:this._pageId,post_id:this._postId}).setMethod('POST').setHandler(this._changeStatusHandler.bind(this)).send();},_stopLinkListener:function(s,t){if(t===this._flyout._flyout.id){m.log('timeline_stop_boosting',this.loggingData);this._changeStatus(false);}},_resumeLinkListener:function(s,t){if(t===this._flyout._flyout.id){m.log('timeline_resume_boosting',this.loggingData);this._changeStatus(true);}},_cancelButtonListener:function(s,t){this._popover.hideLayer();},_setBudgetListener:function(s,t){this._changeStatusHandler(t);},_changeStatus:function(s){this._statusThrobber&&k.show(this._statusThrobber);new i('/ads/ajax/boosted/edit.php').setData({status:s,page_id:this._pageId,post_id:this._postId}).setMethod('POST').setHandler(this._changeStatusHandler.bind(this)).send();},_initializeFlyoutListeners:function(){this._flyout.subscribe(n.SAVE,this._createListener.bind(this));this._flyout.subscribe(n.CANCEL,this._cancelButtonListener.bind(this));g.subscribe(n.STOP,this._stopLinkListener.bind(this));g.subscribe(n.RESUME,this._resumeLinkListener.bind(this));this._flyout.subscribe(n.CLOSE,this._cancelButtonListener.bind(this));this._flyout.subscribe(n.SET_BUDGET,this._setBudgetListener.bind(this));},_onFirstClick:function(){if(!this._flyout)this._popover.setLayerContent(this._loadingMenu.getRoot());if(this._firstClickListener){this._firstClickListener.remove();this._firstClickListener=null;}this._fetchFlyout();if(!this._isBoosted)m.logClickConversionTracking(this._pageId,this._postId,this._campaignId,this._campaignPlacement);},_fetchFlyout:function(){if(this._fetched)return;new i('/ads/ajax/boosted/post_widget.php').setData({pmid:this._instanceId,page_id:this._pageId,post_id:this._postId,auto_open_popover:this._autoOpenPopover}).send();this._fetched=true;if(this._mouseoverListener){this._mouseoverListener.remove();this._mouseoverListener=null;}},_changeStatusHandler:function(s){this._popover.hideLayer();l.empty(this._flyout);l.replace(this._popoverButton,s.payload);this._popoverButton=s.payload;},setFlyout:function(s,t){this._popover.setLayerContent(s);this._flyout=t;this._initializeFlyoutListeners();this._statusThrobber=l.scry(s,'.statusThrobber')[0];if(this._createLogWaitingForFlyout){this._logOnFlyoutOpen();this._createLogWaitingForFlyout=false;}},_logOnFlyoutOpen:function(){var s=!this._isBoosted?'timeline_create_flyout_open':'timeline_edit_flyout_open';if(!this._isBoosted)this.loggingData.has_credit_card=this._flyout.userHasPaymentInfo();m.log(s,this.loggingData);}});e.exports=r;});
__d("insights-constants",["tx","uki-utils"],function(a,b,c,d,e,f){var g=b('tx'),h=b('uki-utils'),i={blue:'#3b5998',green:'#a9bc60',magenta:'#a856a1',teal:'#5d9d90',brown:'#886d4f'},j={API_ERROR_NUM_RETRIES:2,SEC_PER_DAY:24*60*60,MS_PER_DAY:24*60*60*1000,MS_PER_MINUTE:60*1000,DAYS_TO_LOOK_BACK:7,INSIGHTS_CUTOFF_TIME:1311058800,DEMOGRAPHICS_MIN_DATE_REACH:1315119600,DEMOGRAPHICS_MIN_PEOPLE_COUNT:30,CHECKINS_TYPE_MIN_DATE_TIMESTAMP:1320217200*1000,MissingValueString:'--',Periods:['day','week','days_28'],DaysInPeriod:{day:1,week:7,days_28:28},ReachTypeLabel:{total:"Total",organic:"Organique",paid:"Pay\u00e9",viral:"Viral"},ReachSourceTypes:['all','page_posts','stories'],ReachSourceTypeSelectorText:{all:"Tous les contenus de Page",page_posts:"Vos publications",stories:"Actualit\u00e9s d\u2019autres personnes"},BreakdownStoryTypes:['all','fan','page post','mention','user post'],BreakdownStoryTypesOptional:['question','coupon','checkin'],BreakdownStoryTypeSelectorText:{all:"Toutes les actualit\u00e9s",fan:"Mentions J\u2019aime pour la Page",'page post':"Actualit\u00e9s \u00e0 partir de vos publications",mention:"Mentions et identifications dans les photos",'user post':"Publications d\u2019autres personnes",checkin:"Visites",question:"Questions",coupon:"Offres"},PostStoryTypes:{like:"Mentions J\u2019aime",comment:"Commentaires",answer:"R\u00e9ponses",rsvp:"R\u00e9ponses",share:"\u00c9l\u00e9ments partag\u00e9s",post:"Publications",claim:"Utilisations d\u2019offres",other:"Autres"},EngagementBreakdownBuckets:{stories:'stories',link_clicks:'link clicks',photo_views:'photo view',video_plays:'video play',other:'other clicks'},EngagementBreakdownLegend:{stories:"Actualit\u00e9s g\u00e9n\u00e9r\u00e9es",'link clicks':"Clics sur des liens",'other clicks':"Autres clics",'photo view':"Affichages de photos",'video play':"Lectures de vid\u00e9os"},LikeSources:{page_suggestion:"Invitation d\u2019un administrateur",timeline:"Journal",ads:"Publicit\u00e9s et actualit\u00e9s sponsoris\u00e9es",registration:"Inscription d\u2019un administrateur",mobile:"Mobile",wizard_suggestion:"Assistant pour les nouveaux utilisateurs",social_graph:"Gestionnaire des mentions J\u2019aime",profile_connect:"Page, fil d\u2019actualit\u00e9 ou t\u00e9lex",external_connect:"Espace J\u2019aime et bouton J\u2019aime",recommended_pages:"Recommandations de Facebook",external_page_like:"J\u2019aime externe",favorites:"Page qui aime une autre Page",api:"Applications de d\u00e9veloppeurs externes",page_browser:"Navigateur de Pages",hovercard:"Survol du curseur",search:"R\u00e9sultats de recherche",page_profile:"Sur la Page",ticker:"T\u00e9lex",like_story:"\u00c0 partir d\u2019amis",nearby_dash:"Lieux proches",from_coupon:"Offre",video_flyout:"Vid\u00e9o",photo_snowlift:"On Photo"},LikeSourcesDeprecatedAggregations:{profile_connect:['hovercard','search','page_profile','ticker','like_story']},Tabs:{wall:"Mur",info:"Information",photos:"Photos",friendactivity:"Activit\u00e9 des amis",videos:"Vid\u00e9os",events:"\u00c9v\u00e8nements",pe:"\u00c9v\u00e8nements pass\u00e9s"},FrequencyBuckets:['1','2','3','4','5','6-10','11-20','21+'],AgeBuckets:['13-17','18-24','25-34','35-44','45-54','55-64','65+'],PostIcons:{photo:'/images/icons/photo.gif',link:'/images/icons/post.gif',coupon:'/images/icons/offers.png',post:'/images/icons/wall_post.gif'},LOADING_IMAGE:'/images/loaders/indicator_blue_small.gif',ColorsMap:i,Colors:h.values(i),TICK_SIZE_THRESHOLD:42,TICK_SIZE_SHORT:7,TICK_SIZE_LONG:14,GraphMaxPoints:{Likes:60,Reach:30,Visits:120,Talking:60,ViralReach:60,CheckinsType:120},GraphType:{BAR:0,AREA:1,LINE:2},ReachBreakdownColors:[i.blue,i.green,i.magenta],EngagementGraphColors:[i.blue,'#758ab7','#b1bdd6','#e2e6f0'],TalkingBreakdownColors:[i.green,'#c3d08f','#dde4bf','#f2f5e7'],PrivacyIcons:{CUSTOM:'/images/privacy/lock_grey.gif',EVERYONE:'/images/icons/audience/feed/everyone.png'},DateFormat:{'n/j/y':'n/j/y','M j':'M j','M j, Y':'M j, Y','m/d/Y g:ia':'m/d/Y g:ia'},MonthAbbrev:{1:'Jan',2:'Feb',3:'Mar',4:'Apr',5:'May',6:'Jun',7:'Jul',8:'Aug',9:'Sep',10:'Oct',11:'Nov',12:'Dec'},AbbrevNumberFormat:{0:'{x0}',1:'{x0}',2:'{x0}',3:'{x3}K',4:'{x3}K',5:'{x3}K',6:'{x6}M',7:'{x6}M',8:'{x6}M',9:'{x9}B',10:'{x9}B',11:'{x9}B'},DecimalSeparator:'.',NumberDelimiter:',',Locale:'en_US',TimeAM:'am',TimePM:'pm',setIntlFormatData:function(k){if(k){this.Locale=k.locale||this.Locale;this.DateFormat=k.date_format||this.DateFormat;this.MonthAbbrev=k.month_abbrev||this.MonthAbbrev;this.AbbrevNumberFormat=k.abbrev_number_format||this.AbbrevNumberFormat;this.DecimalSeparator=k.decimal_separator||this.DecimalSeparator;this.NumberDelimiter=k.number_delimiter||this.NumberDelimiter;this.TimeAM=k.time_am||this.TimeAM;this.TimePM=k.time_pm||this.TimePM;}},PST_OFFSET_MS:8*60*60*1000,PDT_OFFSET_MS:7*60*60*1000,getPTOffset:function(k){if(k<=1.32057e+12){return j.PDT_OFFSET_MS;}else if(k<=1.33146e+12){return j.PST_OFFSET_MS;}else if(k<=1352019600000){return j.PDT_OFFSET_MS;}else if(k<=1362909600000){return j.PST_OFFSET_MS;}else if(k<=1383469200000){return j.PDT_OFFSET_MS;}else if(k<=1394359200000){return j.PST_OFFSET_MS;}else if(k<=1414918800000){return j.PDT_OFFSET_MS;}else if(k<=1425808800000){return j.PST_OFFSET_MS;}else if(k<=1446368400000){return j.PDT_OFFSET_MS;}else return j.PST_OFFSET_MS;},Events:{Ready:'ready',Plotted:'plotted',ShowMorePosts:'showMorePosts',Error:'error'},InternalFBApps:{Photos:'2305272732',Video:'2392950137',Mobile:'2915120374'},MAX_INT:9007199254740992};j.InternalFBAppsIDs=(function(){var k={};h.forEach(j.InternalFBApps,function(l,m){k[l]=m;});return k;})();f.InsightsConstants=j;});
__d("insights-date-utils",["insights-constants"],function(a,b,c,d,e,f){var g=b('insights-constants').InsightsConstants,h={shortDate:function(p){return h._applyFormat(g.DateFormat['n/j/y'],p);},dateAndTime:function(p,q){return h._applyFormat(g.DateFormat['m/d/Y g:ia'],p,q);},abbrevMonthDateFromTimestamp:function(p){return h._applyFormat(g.DateFormat['M j'],new Date(p));},abbrevMonthAndYear:function(p){return h._applyFormat(g.DateFormat['M j, Y'],new Date(p));},_applyFormat:function(p,q,r){var s=null;if(r){var t=q.getTimezoneOffset()*g.MS_PER_MINUTE;s=new Date(q.getTime()-t);}else{var u=q.getTime()-g.getPTOffset(q.getTime());s=new Date(g.MS_PER_DAY*Math.round(u/g.MS_PER_DAY));}return p.replace(/(\\)?y/g,function(v,w){return w?v:(''+s.getUTCFullYear()).substr(2);}).replace(/(\\)?Y/g,function(v,w){return w?v:s.getUTCFullYear();}).replace(/(\\)?(j|d)/g,function(v,w){return w?v:s.getUTCDate();}).replace(/(\\)?(m|n)/g,function(v,w){return w?v:s.getUTCMonth()+1;}).replace(/(\\)?(F|M)/g,function(v,w){return w?v:h._escapeLetters(g.MonthAbbrev[s.getUTCMonth()+1]);}).replace(/(\\)?(G|H)/g,function(v,w){return w?v:s.getUTCHours();}).replace(/(\\)?(g|h)/g,function(v,w){return w?v:(s.getUTCHours()%12===0?12:s.getUTCHours()%12);}).replace(/(\\)?(m|i)/g,function(v,w){var x=s.getUTCMinutes();return w?v:x<10?'0'+x:x;}).replace(/(\\)?a/g,function(v,w){return w?v:h._escapeLetters(s.getUTCHours()<12?g.TimeAM:g.TimePM);}).replace(/\\/g,'');},_escapeLetters:function(p){return p.replace(/[a-zA-Z]/g,function(q){return '\\'+q;});},fullRange:function(p){var q={since:this.shortDate(new Date(p.since*1000)),until:this.shortDate(new Date(p.until*1000))};q.date=q.until;return q;},periodRange:function(p){var q=k(new Date(p.until*1000),p.period),r={since:h.shortDate(q),until:h.shortDate(new Date(p.until*1000))};r.date=r.until;return r;},weekRangeString:function(p){var q=h.periodRange({until:p/1000,period:'week'});return q.since+' - '+q.until;}},i=function(p){var q=new Date(p.getTime()-g.getPTOffset(p.getTime()));return new Date(q.getUTCFullYear(),q.getUTCMonth(),q.getUTCDate());},j=function(p,q){if(!q)p=o(p);return new Date(p);},k=function(p,q){var r=new Date(p);r.setDate(r.getDate()-(g.DaysInPeriod[q]-1));return r;},l=function(p){var q={since:(n(p.since*1000)/1000)-1,until:n(p.until*1000)/1000};if(p.date_threshold&&p.date_threshold<=q.until)q.until=p.date_threshold;return q;},m=function(p,q){var r=[],s=p;while(s<=q){r.push(s);s=n(s);}return r;},n=function(p){var q=g.getPTOffset(p),r=g.getPTOffset(p+g.MS_PER_DAY);return p+g.MS_PER_DAY+r-q;},o=function(p){var q=g.getPTOffset(p),r=g.getPTOffset(p-g.MS_PER_DAY);return p-g.MS_PER_DAY+r-q;};f.mostRecentMidnightPT=i;f.endTimeToDate=j;f.rangeForAPIQuery=l;f.midnightsInRange=m;f.nextMidnight=n;f.previousMidnight=o;f.DateFormatter=h;});
__d("insights-number-utils",["insights-constants"],function(a,b,c,d,e,f){var g=b('insights-constants').InsightsConstants,h={magnitude:function(i){return i>=10?Math.floor(Math.log(i)/Math.log(10)):0;},abbrevInt:function(i){var j=h.magnitude(i),k=Math.round(i/Math.pow(10,j));if(k==10){k=1;j++;}var l=g.AbbrevNumberFormat[j]||'{x0}',m=l.replace(/(.*)(\{x(\d+)\})(.*)/,function(o,p,q,r,s){return p+h.decimal(i/Math.pow(10,r))+s;}),n=h.integer(i);return m.length>=n.length||m==i?n:m;},decOrInt:function(i){return i===Math.floor(i)?h.integer(i):h.decimal(i);},integer:function(i){if(i==null||i==='')return g.MissingValueString;var j=''+i;if(i<10000&&(g.Locale=='nb_NO'||g.Locale=='nn_NO'))return j;var k=/(\d+)(\d{3})/;while(k.test(j))j=j.replace(k,'$1'+g.NumberDelimiter+'$2');return j;},percent:function(i){return h.round(i*100,2)+'%';},decimal:function(i){return h.round(i,1);},round:function(i,j,k){var l=Math.pow(10,j),m=(Math.round(i*l)/l+'').replace('.',g.DecimalSeparator);if(!j||!k)return m;var n=m.indexOf(g.DecimalSeparator),o=0;if(n==-1){m+=g.DecimalSeparator;o=j;}else o=j-(m.length-n-1);for(var p=0;p<o;p++)m+='0';return m;}};f.NumberFormatter=h;});
__d("requireText",[],function(a,b,c,d,e,f){function g(h){throw new Error('requireText: Unexpected class transformation.');}e.exports=g;});
/**
 * @providesModule ExCanvas
 * @option preserve-header
 *
 * Copyright 2006 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */__d("ExCanvas",[],function(a,b,c,d,e,f){var g={};if(!document.createElement('canvas').getContext){var i=Math,j=i.round,k=i.sin,m=i.cos,n=i.abs,o=i.sqrt,p=10,q=p/2;function r(){return this.context_||(this.context_=new sa(this));}var t=Array.prototype.slice;function u(h,l,s){var fb=t.call(arguments,2);return function(){return h.apply(l,fb.concat(t.call(arguments)));};}function v(h){return String(h).replace(/&/g,"&amp;").replace(/"/g,"&quot;");}function w(h){if(!h.namespaces.g_vml_)h.namespaces.add("g_vml_","urn:schemas-microsoft-com:vml","#default#VML");if(!h.namespaces.g_o_)h.namespaces.add("g_o_","urn:schemas-microsoft-com:office:office","#default#VML");if(!h.styleSheets.ex_canvas_){var l=h.createStyleSheet();l.owningElement.id="ex_canvas_";l.cssText="canvas{display:inline-block;overflow:hidden;text-align:left;width:300px;height:150px}";}}w(document);var x={init:function(h){if(/MSIE/.test(navigator.userAgent)&&!window.opera){var l=h||document;l.createElement("canvas");l.attachEvent("onreadystatechange",u(this.init_,this,l));}},init_:function(h){var l=h.getElementsByTagName("canvas");for(var s=0;s<l.length;s++)this.initElement(l[s]);},initElement:function(h){if(!h.getContext){h.getContext=r;w(h.ownerDocument);h.innerHTML="";h.attachEvent("onpropertychange",y);h.attachEvent("onresize",z);var l=h.attributes;if(l.width&&l.width.specified){h.style.width=l.width.nodeValue+"px";}else h.width=h.clientWidth;if(l.height&&l.height.specified){h.style.height=l.height.nodeValue+"px";}else h.height=h.clientHeight;}return h;}};function y(h){var l=h.srcElement;switch(h.propertyName){case "width":l.getContext().clearRect();l.style.width=l.attributes.width.nodeValue+"px";l.firstChild.style.width=l.clientWidth+"px";break;case "height":l.getContext().clearRect();l.style.height=l.attributes.height.nodeValue+"px";l.firstChild.style.height=l.clientHeight+"px";break;}}function z(h){var l=h.srcElement;if(l.firstChild){l.firstChild.style.width=l.clientWidth+"px";l.firstChild.style.height=l.clientHeight+"px";}}x.init();var aa=[];for(var ba=0;ba<16;ba++)for(var ca=0;ca<16;ca++)aa[ba*16+ca]=ba.toString(16)+ca.toString(16);function da(){return [[1,0,0],[0,1,0],[0,0,1]];}function ea(h,l){var s=da();for(var fb=0;fb<3;fb++)for(var gb=0;gb<3;gb++){var hb=0;for(var ib=0;ib<3;ib++)hb+=h[fb][ib]*l[ib][gb];s[fb][gb]=hb;}return s;}function fa(h,l){l.fillStyle=h.fillStyle;l.lineCap=h.lineCap;l.lineJoin=h.lineJoin;l.lineWidth=h.lineWidth;l.miterLimit=h.miterLimit;l.shadowBlur=h.shadowBlur;l.shadowColor=h.shadowColor;l.shadowOffsetX=h.shadowOffsetX;l.shadowOffsetY=h.shadowOffsetY;l.strokeStyle=h.strokeStyle;l.globalAlpha=h.globalAlpha;l.font=h.font;l.textAlign=h.textAlign;l.textBaseline=h.textBaseline;l.arcScaleX_=h.arcScaleX_;l.arcScaleY_=h.arcScaleY_;l.lineScale_=h.lineScale_;}function ga(h){var l=h.indexOf("(",3),s=h.indexOf(")",l+1),fb=h.substring(l+1,s).split(",");if(fb.length==4&&h.substr(3,1)=="a"){alpha=Number(fb[3]);}else fb[3]=1;return fb;}function ha(h){return parseFloat(h)/100;}function ia(h,l,s){return Math.min(s,Math.max(l,h));}function ja(fb){var gb,hb,ib;h=parseFloat(fb[0])/360%360;if(h<0)h++;s=ia(ha(fb[1]),0,1);l=ia(ha(fb[2]),0,1);if(s==0){gb=hb=ib=l;}else{var jb=l<.5?l*(1+s):l+s-l*s,kb=2*l-jb;gb=ka(kb,jb,h+1/3);hb=ka(kb,jb,h);ib=ka(kb,jb,h-1/3);}return "#"+aa[Math.floor(gb*255)]+aa[Math.floor(hb*255)]+aa[Math.floor(ib*255)];}function ka(h,l,s){if(s<0)s++;if(s>1)s--;if(6*s<1){return h+(l-h)*6*s;}else if(2*s<1){return l;}else if(3*s<2){return h+(l-h)*(2/3-s)*6;}else return h;}function la(h){var l,s=1;h=String(h);if(h.charAt(0)=="#"){l=h;}else if(/^rgb/.test(h)){var fb=ga(h),l="#",gb;for(var hb=0;hb<3;hb++){if(fb[hb].indexOf("%")!=-1){gb=Math.floor(ha(fb[hb])*255);}else gb=Number(fb[hb]);l+=aa[ia(gb,0,255)];}s=fb[3];}else if(/^hsl/.test(h)){var fb=ga(h);l=ja(fb);s=fb[3];}else l=h;return {color:l,alpha:s};}var ma={style:"normal",variant:"normal",weight:"normal",size:10,family:"sans-serif"},na={};function oa(h){if(na[h])return na[h];var l=document.createElement("div"),s=l.style;try{s.font=h;}catch(fb){}return na[h]={style:s.fontStyle||ma.style,variant:s.fontVariant||ma.variant,weight:s.fontWeight||ma.weight,size:s.fontSize||ma.size,family:s.fontFamily||ma.family};}function pa(h,l){var s={};for(var fb in h)s[fb]=h[fb];var gb=parseFloat(l.currentStyle.fontSize),hb=parseFloat(h.size);if(typeof h.size=="number"){s.size=h.size;}else if(h.size.indexOf("px")!=-1){s.size=hb;}else if(h.size.indexOf("em")!=-1){s.size=gb*hb;}else if(h.size.indexOf("%")!=-1){s.size=(gb/100)*hb;}else if(h.size.indexOf("pt")!=-1){s.size=hb/.75;}else s.size=gb;s.size*=.981;return s;}function qa(h){return h.style+" "+h.variant+" "+h.weight+" "+h.size+"px "+h.family;}function ra(h){switch(h){case "butt":return "flat";case "round":return "round";case "square":default:return "square";}}function sa(h){this.m_=da();this.mStack_=[];this.aStack_=[];this.currentPath_=[];this.strokeStyle="#000";this.fillStyle="#000";this.lineWidth=1;this.lineJoin="miter";this.lineCap="butt";this.miterLimit=p*1;this.globalAlpha=1;this.font="10px sans-serif";this.textAlign="left";this.textBaseline="alphabetic";this.canvas=h;var l=h.ownerDocument.createElement("div");l.style.width=h.clientWidth+"px";l.style.height=h.clientHeight+"px";l.style.overflow="hidden";l.style.position="absolute";h.appendChild(l);this.element_=l;this.arcScaleX_=1;this.arcScaleY_=1;this.lineScale_=1;}var ta=sa.prototype;ta.clearRect=function(){if(this.textMeasureEl_){this.textMeasureEl_.removeNode(true);this.textMeasureEl_=null;}this.element_.innerHTML="";};ta.beginPath=function(){this.currentPath_=[];};ta.moveTo=function(h,l){var s=this.getCoords_(h,l);this.currentPath_.push({type:"moveTo",x:s.x,y:s.y});this.currentX_=s.x;this.currentY_=s.y;};ta.lineTo=function(h,l){var s=this.getCoords_(h,l);this.currentPath_.push({type:"lineTo",x:s.x,y:s.y});this.currentX_=s.x;this.currentY_=s.y;};ta.bezierCurveTo=function(h,l,s,fb,gb,hb){var ib=this.getCoords_(gb,hb),jb=this.getCoords_(h,l),kb=this.getCoords_(s,fb);ua(this,jb,kb,ib);};function ua(h,l,s,fb){h.currentPath_.push({type:"bezierCurveTo",cp1x:l.x,cp1y:l.y,cp2x:s.x,cp2y:s.y,x:fb.x,y:fb.y});h.currentX_=fb.x;h.currentY_=fb.y;}ta.quadraticCurveTo=function(h,l,s,fb){var gb=this.getCoords_(h,l),hb=this.getCoords_(s,fb),ib={x:this.currentX_+2/3*(gb.x-this.currentX_),y:this.currentY_+2/3*(gb.y-this.currentY_)},jb={x:ib.x+(hb.x-this.currentX_)/3,y:ib.y+(hb.y-this.currentY_)/3};ua(this,ib,jb,hb);};ta.arc=function(h,l,s,fb,gb,hb){s*=p;var ib=hb?"at":"wa",jb=h+m(fb)*s-q,kb=l+k(fb)*s-q,lb=h+m(gb)*s-q,mb=l+k(gb)*s-q;if(jb==lb&&!hb)jb+=.125;var nb=this.getCoords_(h,l),ob=this.getCoords_(jb,kb),pb=this.getCoords_(lb,mb);this.currentPath_.push({type:ib,x:nb.x,y:nb.y,radius:s,xStart:ob.x,yStart:ob.y,xEnd:pb.x,yEnd:pb.y});};ta.rect=function(h,l,s,fb){this.moveTo(h,l);this.lineTo(h+s,l);this.lineTo(h+s,l+fb);this.lineTo(h,l+fb);this.closePath();};ta.strokeRect=function(h,l,s,fb){var gb=this.currentPath_;this.beginPath();this.moveTo(h,l);this.lineTo(h+s,l);this.lineTo(h+s,l+fb);this.lineTo(h,l+fb);this.closePath();this.stroke();this.currentPath_=gb;};ta.fillRect=function(h,l,s,fb){var gb=this.currentPath_;this.beginPath();this.moveTo(h,l);this.lineTo(h+s,l);this.lineTo(h+s,l+fb);this.lineTo(h,l+fb);this.closePath();this.fill();this.currentPath_=gb;};ta.createLinearGradient=function(h,l,s,fb){var gb=new za("gradient");gb.x0_=h;gb.y0_=l;gb.x1_=s;gb.y1_=fb;return gb;};ta.createRadialGradient=function(h,l,s,fb,gb,hb){var ib=new za("gradientradial");ib.x0_=h;ib.y0_=l;ib.r0_=s;ib.x1_=fb;ib.y1_=gb;ib.r1_=hb;return ib;};ta.drawImage=function(h,l){var s,fb,gb,hb,ib,jb,kb,lb,mb=h.runtimeStyle.width,nb=h.runtimeStyle.height;h.runtimeStyle.width="auto";h.runtimeStyle.height="auto";var ob=h.width,pb=h.height;h.runtimeStyle.width=mb;h.runtimeStyle.height=nb;if(arguments.length==3){s=arguments[1];fb=arguments[2];ib=jb=0;kb=gb=ob;lb=hb=pb;}else if(arguments.length==5){s=arguments[1];fb=arguments[2];gb=arguments[3];hb=arguments[4];ib=jb=0;kb=ob;lb=pb;}else if(arguments.length==9){ib=arguments[1];jb=arguments[2];kb=arguments[3];lb=arguments[4];s=arguments[5];fb=arguments[6];gb=arguments[7];hb=arguments[8];}else throw Error("Invalid number of arguments");var qb=this.getCoords_(s,fb),rb=kb/2,sb=lb/2,tb=[],ub=10,vb=10;tb.push(" <g_vml_:group",' coordsize="',p*ub,",",p*vb,'"',' coordorigin="0,0"',' style="width:',ub,"px;height:",vb,"px;position:absolute;");if(this.m_[0][0]!=1||this.m_[0][1]||this.m_[1][1]!=1||this.m_[1][0]){var wb=[];wb.push("M11=",this.m_[0][0],",","M12=",this.m_[1][0],",","M21=",this.m_[0][1],",","M22=",this.m_[1][1],",","Dx=",j(qb.x/p),",","Dy=",j(qb.y/p),"");var xb=qb,yb=this.getCoords_(s+gb,fb),zb=this.getCoords_(s,fb+hb),ac=this.getCoords_(s+gb,fb+hb);xb.x=i.max(xb.x,yb.x,zb.x,ac.x);xb.y=i.max(xb.y,yb.y,zb.y,ac.y);tb.push("padding:0 ",j(xb.x/p),"px ",j(xb.y/p),"px 0;filter:progid:DXImageTransform.Microsoft.Matrix(",wb.join(""),", sizingmethod='clip');");}else tb.push("top:",j(qb.y/p),"px;left:",j(qb.x/p),"px;");tb.push(' ">','<g_vml_:image src="',h.src,'"',' style="width:',p*gb,"px;"," height:",p*hb,'px"',' cropleft="',ib/ob,'"',' croptop="',jb/pb,'"',' cropright="',(ob-ib-kb)/ob,'"',' cropbottom="',(pb-jb-lb)/pb,'"'," />","</g_vml_:group>");this.element_.insertAdjacentHTML("BeforeEnd",tb.join(""));};ta.stroke=function(h){var l=10,s=10,fb=5000,gb={x:null,y:null},hb={x:null,y:null};for(var ib=0;ib<this.currentPath_.length;ib+=fb){var jb=[],kb=false;jb.push("<g_vml_:shape",' filled="',!!h,'"',' style="position:absolute;width:',l,"px;height:",s,'px;"',' coordorigin="0,0"',' coordsize="',p*l,",",p*s,'"',' stroked="',!h,'"',' path="');var lb=false;for(var mb=ib;mb<Math.min(ib+fb,this.currentPath_.length);mb++){if(mb%fb==0&&mb>0)jb.push(" m ",j(this.currentPath_[mb-1].x),",",j(this.currentPath_[mb-1].y));var nb=this.currentPath_[mb],ob;switch(nb.type){case "moveTo":ob=nb;jb.push(" m ",j(nb.x),",",j(nb.y));break;case "lineTo":jb.push(" l ",j(nb.x),",",j(nb.y));break;case "close":jb.push(" x ");nb=null;break;case "bezierCurveTo":jb.push(" c ",j(nb.cp1x),",",j(nb.cp1y),",",j(nb.cp2x),",",j(nb.cp2y),",",j(nb.x),",",j(nb.y));break;case "at":case "wa":jb.push(" ",nb.type," ",j(nb.x-this.arcScaleX_*nb.radius),",",j(nb.y-this.arcScaleY_*nb.radius)," ",j(nb.x+this.arcScaleX_*nb.radius),",",j(nb.y+this.arcScaleY_*nb.radius)," ",j(nb.xStart),",",j(nb.yStart)," ",j(nb.xEnd),",",j(nb.yEnd));break;}if(nb){if(gb.x==null||nb.x<gb.x)gb.x=nb.x;if(hb.x==null||nb.x>hb.x)hb.x=nb.x;if(gb.y==null||nb.y<gb.y)gb.y=nb.y;if(hb.y==null||nb.y>hb.y)hb.y=nb.y;}}jb.push(' ">');if(!h){va(this,jb);}else wa(this,jb,gb,hb);jb.push("</g_vml_:shape>");this.element_.insertAdjacentHTML("beforeEnd",jb.join(""));}};function va(h,l){var s=la(h.strokeStyle),fb=s.color,gb=s.alpha*h.globalAlpha,hb=h.lineScale_*h.lineWidth;if(hb<1)gb*=hb;l.push("<g_vml_:stroke",' opacity="',gb,'"',' joinstyle="',h.lineJoin,'"',' miterlimit="',h.miterLimit,'"',' endcap="',ra(h.lineCap),'"',' weight="',hb,'px"',' color="',fb,'" />');}function wa(h,l,s,fb){var gb=h.fillStyle,hb=h.arcScaleX_,ib=h.arcScaleY_,jb=fb.x-s.x,kb=fb.y-s.y;if(gb instanceof za){var lb=0,mb={x:0,y:0},nb=0,ob=1;if(gb.type_=="gradient"){var pb=gb.x0_/hb,qb=gb.y0_/ib,rb=gb.x1_/hb,sb=gb.y1_/ib,tb=h.getCoords_(pb,qb),ub=h.getCoords_(rb,sb),vb=ub.x-tb.x,wb=ub.y-tb.y;lb=Math.atan2(vb,wb)*180/Math.PI;if(lb<0)lb+=360;if(lb<1e-06)lb=0;}else{var tb=h.getCoords_(gb.x0_,gb.y0_);mb={x:(tb.x-s.x)/jb,y:(tb.y-s.y)/kb};jb/=hb*p;kb/=ib*p;var xb=i.max(jb,kb);nb=2*gb.r0_/xb;ob=2*gb.r1_/xb-nb;}var yb=gb.colors_;yb.sort(function(mc,nc){return mc.offset-nc.offset;});var zb=yb.length,ac=yb[0].color,bc=yb[zb-1].color,cc=yb[0].alpha*h.globalAlpha,dc=yb[zb-1].alpha*h.globalAlpha,ec=[];for(var fc=0;fc<zb;fc++){var gc=yb[fc];ec.push(gc.offset*ob+nb+" "+gc.color);}l.push('<g_vml_:fill type="',gb.type_,'"',' method="none" focus="100%"',' color="',ac,'"',' color2="',bc,'"',' colors="',ec.join(","),'"',' opacity="',dc,'"',' g_o_:opacity2="',cc,'"',' angle="',lb,'"',' focusposition="',mb.x,",",mb.y,'" />');}else if(gb instanceof ab){if(jb&&kb){var hc=-s.x,ic=-s.y;l.push("<g_vml_:fill",' position="',hc/jb*hb*hb,",",ic/kb*ib*ib,'"',' type="tile"',' src="',gb.src_,'" />');}}else{var jc=la(h.fillStyle),kc=jc.color,lc=jc.alpha*h.globalAlpha;l.push('<g_vml_:fill color="',kc,'" opacity="',lc,'" />');}}ta.fill=function(){this.stroke(true);};ta.closePath=function(){this.currentPath_.push({type:"close"});};ta.getCoords_=function(h,l){var s=this.m_;return {x:p*(h*s[0][0]+l*s[1][0]+s[2][0])-q,y:p*(h*s[0][1]+l*s[1][1]+s[2][1])-q};};ta.save=function(){var h={};fa(this,h);this.aStack_.push(h);this.mStack_.push(this.m_);this.m_=ea(da(),this.m_);};ta.restore=function(){if(this.aStack_.length){fa(this.aStack_.pop(),this);this.m_=this.mStack_.pop();}};function xa(h){return isFinite(h[0][0])&&isFinite(h[0][1])&&isFinite(h[1][0])&&isFinite(h[1][1])&&isFinite(h[2][0])&&isFinite(h[2][1]);}function ya(h,l,s){if(!xa(l))return;h.m_=l;if(s){var fb=l[0][0]*l[1][1]-l[0][1]*l[1][0];h.lineScale_=o(n(fb));}}ta.translate=function(h,l){var s=[[1,0,0],[0,1,0],[h,l,1]];ya(this,ea(s,this.m_),false);};ta.rotate=function(h){var l=m(h),s=k(h),fb=[[l,s,0],[-s,l,0],[0,0,1]];ya(this,ea(fb,this.m_),false);};ta.scale=function(h,l){this.arcScaleX_*=h;this.arcScaleY_*=l;var s=[[h,0,0],[0,l,0],[0,0,1]];ya(this,ea(s,this.m_),true);};ta.transform=function(h,l,s,fb,gb,hb){var ib=[[h,l,0],[s,fb,0],[gb,hb,1]];ya(this,ea(ib,this.m_),true);};ta.setTransform=function(h,l,s,fb,gb,hb){var ib=[[h,l,0],[s,fb,0],[gb,hb,1]];ya(this,ib,true);};ta.drawText_=function(h,l,s,fb,gb){var hb=this.m_,ib=1000,jb=0,kb=ib,lb={x:0,y:0},mb=[],nb=pa(oa(this.font),this.element_),ob=qa(nb),pb=this.element_.currentStyle,qb=this.textAlign.toLowerCase();switch(qb){case "left":case "center":case "right":break;case "end":qb=pb.direction=="ltr"?"right":"left";break;case "start":qb=pb.direction=="rtl"?"right":"left";break;default:qb="left";}switch(this.textBaseline){case "hanging":case "top":lb.y=nb.size/1.75;break;case "middle":break;default:case null:case "alphabetic":case "ideographic":case "bottom":lb.y=-nb.size/2.25;break;}switch(qb){case "right":jb=ib;kb=.05;break;case "center":jb=kb=ib/2;break;}var rb=this.getCoords_(l+lb.x,s+lb.y);mb.push('<g_vml_:line from="',-jb,' 0" to="',kb,' 0.05" ',' coordsize="100 100" coordorigin="0 0"',' filled="',!gb,'" stroked="',!!gb,'" style="position:absolute;width:1px;height:1px;">');if(gb){va(this,mb);}else wa(this,mb,{x:-jb,y:0},{x:kb,y:nb.size});var sb=hb[0][0].toFixed(3)+","+hb[1][0].toFixed(3)+","+hb[0][1].toFixed(3)+","+hb[1][1].toFixed(3)+",0,0",tb=j(rb.x/p)+","+j(rb.y/p);mb.push('<g_vml_:skew on="t" matrix="',sb,'" ',' offset="',tb,'" origin="',jb,' 0" />','<g_vml_:path textpathok="true" />','<g_vml_:textpath on="true" string="',v(h),'" style="v-text-align:',qb,";font:",v(ob),'" /></g_vml_:line>');this.element_.insertAdjacentHTML("beforeEnd",mb.join(""));};ta.fillText=function(h,l,s,fb){this.drawText_(h,l,s,fb,false);};ta.strokeText=function(h,l,s,fb){this.drawText_(h,l,s,fb,true);};ta.measureText=function(h){if(!this.textMeasureEl_){var l='<span style="position:absolute;top:-20000px;left:0;padding:0;margin:0;border:none;white-space:pre;"></span>';this.element_.insertAdjacentHTML("beforeEnd",l);this.textMeasureEl_=this.element_.lastChild;}var s=this.element_.ownerDocument;this.textMeasureEl_.innerHTML="";this.textMeasureEl_.style.font=this.font;this.textMeasureEl_.appendChild(s.createTextNode(h));return {width:this.textMeasureEl_.offsetWidth};};ta.clip=function(){};ta.arcTo=function(){};ta.createPattern=function(h,l){return new ab(h,l);};function za(h){this.type_=h;this.x0_=0;this.y0_=0;this.r0_=0;this.x1_=0;this.y1_=0;this.r1_=0;this.colors_=[];}za.prototype.addColorStop=function(h,l){l=la(l);this.colors_.push({offset:h,color:l.color,alpha:l.alpha});};function ab(h,l){cb(h);switch(l){case "repeat":case null:case "":this.repetition_="repeat";break;case "repeat-x":case "repeat-y":case "no-repeat":this.repetition_=l;break;default:bb("SYNTAX_ERR");}this.src_=h.src;this.width_=h.width;this.height_=h.height;}function bb(h){throw new db(h);}function cb(h){if(!h||h.nodeType!=1||h.tagName!="IMG")bb("TYPE_MISMATCH_ERR");if(h.readyState!="complete")bb("INVALID_STATE_ERR");}function db(h){this.code=this[h];this.message=h+": DOM Exception "+this.code;}var eb=db.prototype=new Error();eb.INDEX_SIZE_ERR=1;eb.DOMSTRING_SIZE_ERR=2;eb.HIERARCHY_REQUEST_ERR=3;eb.WRONG_DOCUMENT_ERR=4;eb.INVALID_CHARACTER_ERR=5;eb.NO_DATA_ALLOWED_ERR=6;eb.NO_MODIFICATION_ALLOWED_ERR=7;eb.NOT_FOUND_ERR=8;eb.NOT_SUPPORTED_ERR=9;eb.INUSE_ATTRIBUTE_ERR=10;eb.INVALID_STATE_ERR=11;eb.SYNTAX_ERR=12;eb.INVALID_MODIFICATION_ERR=13;eb.NAMESPACE_ERR=14;eb.INVALID_ACCESS_ERR=15;eb.VALIDATION_ERR=16;eb.TYPE_MISMATCH_ERR=17;g={CanvasGradient:za,CanvasPattern:ab,CanvasRenderingContext2D:sa,DOMException:db,G_vmlCanvasManager:x};}e.exports=g;});
__d("insights-view-base-graph",["uki-function","uki-dom","uki-view","uki-builder","uki-utils","flot","DoNotUseJQuery17","insights-constants","uki-fb-view-image","uki-view-container"],function(a,b,c,d,e,f){var g=b('uki-function'),h=b('uki-dom'),i=b('uki-view'),j=b('uki-builder').build,k=b('uki-utils'),l=b('flot'),m=b('DoNotUseJQuery17'),n=b('insights-constants').InsightsConstants,o=b('uki-fb-view-image').Image,p=b('uki-view-container').Container,q=i.newClass('insights.BaseGraph',p,{_createDom:function(r){this._dom=h.createElement('div');var s=j({view:p,childViews:[{view:o,as:'loading',src:n.LOADING_IMAGE},{view:p,className:'graph-canvas',as:'canvas'}]});s.appendTo(this);this._loading=s.view('loading');this._canvas=s.view('canvas');this.loading(true);this.options({});this.legend([]);},loading:g.newDelegateProp('_loading','visible'),legendContainer:g.newProp('legendContainer'),noColumnsLegend:g.newProp('noColumnsLegend'),legendStyle:g.newProp('legendStyle'),maxPoints:g.newProp('maxPoints'),xMin:g.newProp('xMin'),colors:g.newProp('colors'),legend:g.newProp('legend'),series:g.newProp('series'),mixins:g.newProp('mixin',function(r){k.forEach(r,g.bind(function(s){k.extend(this.options(),s.options());},this));}),options:g.newProp('options'),_flotData:function(){var r=[];for(var s=0;s<this.series().length;s++)r.push({data:this.series()[s],label:this._chooseLabel(s),color:this._chooseColor(s)});return r;},_legendOptions:function(){return {legend:{container:this.legendContainer()?this.legendContainer().dom():null,style:this.legendStyle(),noColumns:this.noColumnsLegend()?this.noColumnsLegend():(this.legend()?this.legend().length:null)}};},_extendOptions:function(r){var s=this.options()||{};k.forEach(r,function(t,u){s[u]=s[u]||{};k.extend(s[u],t);});return this.options(s);},_flotOptions:function(){this._extendOptions(this._legendOptions());var r=this.options();if(r.points&&r.points.show&&this.series()&&this.maxPoints()&&this.series()[0].length>this.maxPoints())r.points.show=false;if(this.xMin()!=null){r.xaxis=r.xaxis||{};r.xaxis.min=this.xMin();}return r;},_chooseLabel:function(r){var s=this.legend();return s&&s.length>r?s[r]:null;},_chooseColor:function(r){var s=this.colors();return s&&s.length>r?s[r]:null;},plot:function(r){if(r!=null)this.series(r);l.plot(this._canvas.dom(),this._flotData(),this._flotOptions());this.trigger({type:n.Events.Plotted});}});f.BaseGraph=q;});
/**
 * @providesModule flot-pie
 * @option preserve-header
 *
 * Copyright (c) 2007-2009 IOLA and Ole Laursen
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use,
 * copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following
 * conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
 * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 * OTHER DEALINGS IN THE SOFTWARE.
 *
 * Flot plugin for rendering pie charts. The plugin assumes the data is
 * coming is as a single data value for each series, and each of those
 * values is a positive value or zero (negative numbers don't make
 * any sense and will cause strange effects). The data values do
 * NOT need to be passed in as percentage values because it
 * internally calculates the total and percentages.
 *
 * * Created by Brian Medendorp, June 2009
 * * Updated November 2009 with contributions from: btburnett3, Anthony Aragues and Xavi Ivars
 *
 * * Changes:
 * 	2009-10-22: lineJoin set to round
 * 	2009-10-23: IE full circle fix, donut
 * 	2009-11-11: Added basic hover from btburnett3 - does not work in IE, and center is off in Chrome and Opera
 * 	2009-11-17: Added IE hover capability submitted by Anthony Aragues
 * 	2009-11-18: Added bug fix submitted by Xavi Ivars (issues with arrays when other JS libraries are included as well)
 *
 *
 * Available options are:
 * series: {
 * 	pie: {
 * 		show: true/false
 * 		radius: 0-1 for percentage of fullsize, or a specified pixel length, or 'auto'
 * 		innerRadius: 0-1 for percentage of fullsize or a specified pixel length, for creating a donut effect
 * 		startAngle: 0-2 factor of PI used for starting angle (in radians) i.e 3/2 starts at the top, 0 and 2 have the same result
 * 		tilt: 0-1 for percentage to tilt the pie, where 1 is no tilt, and 0 is completely flat (nothing will show)
 * 		offset: {
 * 			top: integer value to move the pie up or down
 * 			left: integer value to move the pie left or right, or 'auto'
 * 		},
 * 		stroke: {
 * 			color: any hexidecimal color value (other formats may or may not work, so best to stick with something like '#FFF')
 * 			width: integer pixel width of the stroke
 * 		},
 * 		label: {
 * 			show: true/false, or 'auto'
 * 			formatter:  a user-defined function that modifies the text/style of the label text
 * 			radius: 0-1 for percentage of fullsize, or a specified pixel length
 * 			background: {
 * 				color: any hexidecimal color value (other formats may or may not work, so best to stick with something like '#000')
 * 				opacity: 0-1
 * 			},
 * 			threshold: 0-1 for the percentage value at which to hide labels (if they're too small)
 * 		},
 * 		combine: {
 * 			threshold: 0-1 for the percentage value at which to combine slices (if they're too small)
 * 			color: any hexidecimal color value (other formats may or may not work, so best to stick with something like '#CCC'), if null, the plugin will automatically use the color of the first slice to be combined
 * 			label: any text value of what the combined slice should be labeled
 * 		}
 * 		highlight: {
 * 			opacity: 0-1
 * 		}
 * 	}
 * }
 *
 * More detail and specific examples can be found in the included HTML file.
 *
 */__d("flot-pie",["DoNotUseJQuery17","flot"],function(a,b,c,d,e,f){var g=b('DoNotUseJQuery17'),h=b('flot');(function(j){function k(m){var n=null,o=null,p=null,q=null,r=null,s=0,t=true,u=10,v=.95,w=0,z=false,aa=false,ba=[];m.hooks.processOptions.push(ca);m.hooks.bindEvents.push(da);function ca(i,x){if(x.series.pie.show){x.grid.show=false;if(x.series.pie.label.show=='auto')if(x.legend.show){x.series.pie.label.show=false;}else x.series.pie.label.show=true;if(x.series.pie.radius=='auto')if(x.series.pie.label.show){x.series.pie.radius=3/4;}else x.series.pie.radius=1;if(x.series.pie.tilt>1)x.series.pie.tilt=1;if(x.series.pie.tilt<0)x.series.pie.tilt=0;i.hooks.processDatapoints.push(ga);i.hooks.drawOverlay.push(ua);i.hooks.draw.push(ka);}}function da(i,x){var y=i.getOptions();if(y.series.pie.show&&y.grid.hoverable)x.unbind('mousemove').mousemove(oa);if(y.series.pie.show&&y.grid.clickable)x.unbind('click').click(pa);}function ea(i){var x='';function y(va,wa){if(!wa)wa=0;for(var xa=0;xa<va.length;++xa){for(var ya=0;ya<wa;ya++)x+='\t';if(typeof va[xa]=="object"){x+=''+xa+':\n';y(va[xa],wa+1);}else x+=''+xa+': '+va[xa]+'\n';}}y(i);alert(x);}function fa(i){for(var x=0;x<i.length;++x){var y=parseFloat(i[x].data[0][1]);if(y)s+=y;}}function ga(i,x,y,va){if(!z){z=true;n=i.getCanvas();o=j(n).parent();l=i.getOptions();i.setData(ja(i.getData()));}}function ha(){w=o.children().filter('.legend').children().width();p=Math.min(n.width,(n.height/l.series.pie.tilt))/2;r=(n.height/2)+l.series.pie.offset.top;q=(n.width/2);if(l.series.pie.offset.left=='auto'){if(l.legend.position.match('w')){q+=w/2;}else q-=w/2;}else q+=l.series.pie.offset.left;if(q<p){q=p;}else if(q>n.width-p)q=n.width-p;}function ia(i){for(var x=0;x<i.length;++x)if(typeof(i[x].data)=='number'){i[x].data=[[1,i[x].data]];}else if(typeof(i[x].data)=='undefined'||typeof(i[x].data[0])=='undefined'){if(typeof(i[x].data)!='undefined'&&typeof(i[x].data.label)!='undefined')i[x].label=i[x].data.label;i[x].data=[[1,0]];}return i;}function ja(i){i=ia(i);fa(i);var x=0,y=0,va=l.series.pie.combine.color,wa=[];for(var xa=0;xa<i.length;++xa){i[xa].data[0][1]=parseFloat(i[xa].data[0][1]);if(!i[xa].data[0][1])i[xa].data[0][1]=0;if(i[xa].data[0][1]/s<=l.series.pie.combine.threshold){x+=i[xa].data[0][1];y++;if(!va)va=i[xa].color;}else wa.push({data:[[1,i[xa].data[0][1]]],color:i[xa].color,label:i[xa].label,angle:(i[xa].data[0][1]*(Math.PI*2))/s,percent:(i[xa].data[0][1]/s*100)});}if(y>0)wa.push({data:[[1,x]],color:va,label:l.series.pie.combine.label,angle:(x*(Math.PI*2))/s,percent:(x/s*100)});return wa;}function ka(i,x){if(!o)return;ctx=x;ha();var y=i.getData(),va=0;while(t&&va<u){t=false;if(va>0)p*=v;va+=1;wa();if(l.series.pie.tilt<=.8)xa();ya();}if(va>=u){wa();o.prepend('<div class="error">Could not draw pie with labels contained inside canvas</div>');}if(i.setSeries&&i.insertLegend){i.setSeries(y);i.insertLegend();}function wa(){ctx.clearRect(0,0,n.width,n.height);o.children().filter('.pieLabel, .pieLabelBackground').remove();}function xa(){var za=5,ab=15,bb=10,cb=.02;if(l.series.pie.radius>1){var db=l.series.pie.radius;}else var db=p*l.series.pie.radius;if(db>=(n.width/2)-za||db*l.series.pie.tilt>=(n.height/2)-ab||db<=bb)return;ctx.save();ctx.translate(za,ab);ctx.globalAlpha=cb;ctx.fillStyle='#000';ctx.translate(q,r);ctx.scale(1,l.series.pie.tilt);for(var eb=1;eb<=bb;eb++){ctx.beginPath();ctx.arc(0,0,db,0,Math.PI*2,false);ctx.fill();db-=eb;}ctx.restore();}function ya(){startAngle=Math.PI*l.series.pie.startAngle;if(l.series.pie.radius>1){var za=l.series.pie.radius;}else var za=p*l.series.pie.radius;ctx.save();ctx.translate(q,r);ctx.scale(1,l.series.pie.tilt);ctx.save();var ab=startAngle;for(var bb=0;bb<y.length;++bb){y[bb].startAngle=ab;cb(y[bb].angle,y[bb].color,true);}ctx.restore();ctx.save();ctx.lineWidth=l.series.pie.stroke.width;ab=startAngle;for(var bb=0;bb<y.length;++bb)cb(y[bb].angle,l.series.pie.stroke.color,false);ctx.restore();la(ctx);if(l.series.pie.label.show)db();ctx.restore();function cb(eb,fb,gb){if(eb<=0)return;if(gb){ctx.fillStyle=fb;}else{ctx.strokeStyle=fb;ctx.lineJoin='round';}ctx.beginPath();if(Math.abs(eb-Math.PI*2)>1e-09){ctx.moveTo(0,0);}else if(j.browser.msie)eb-=.0001;ctx.arc(0,0,za,ab,ab+eb,false);ctx.closePath();ab+=eb;if(gb){ctx.fill();}else ctx.stroke();}function db(){var eb=startAngle;if(l.series.pie.label.radius>1){var fb=l.series.pie.label.radius;}else var fb=p*l.series.pie.label.radius;for(var gb=0;gb<y.length;++gb){if(y[gb].percent>=l.series.pie.label.threshold*100)hb(y[gb],eb,gb);eb+=y[gb].angle;}function hb(ib,jb,kb){if(ib.data[0][1]==0)return;var lb=l.legend.labelFormatter,mb,nb=l.series.pie.label.formatter;if(lb){mb=lb(ib.label,ib);}else mb=ib.label;if(nb)mb=nb(mb,ib);var ob=((jb+ib.angle)+jb)/2,pb=q+Math.round(Math.cos(ob)*fb),qb=r+Math.round(Math.sin(ob)*fb)*l.series.pie.tilt,rb='<span class="pieLabel" id="pieLabel'+kb+'" style="position:absolute;top:'+qb+'px;left:'+pb+'px;">'+mb+"</span>";o.append(rb);var sb=o.children('#pieLabel'+kb),tb=(qb-sb.height()/2),ub=(pb-sb.width()/2);sb.css('top',tb);sb.css('left',ub);if(0-tb>0||0-ub>0||n.height-(tb+sb.height())<0||n.width-(ub+sb.width())<0)t=true;if(l.series.pie.label.background.opacity!=0){var vb=l.series.pie.label.background.color;if(vb==null)vb=ib.color;var wb='top:'+tb+'px;left:'+ub+'px;';j('<div class="pieLabelBackground" style="position:absolute;width:'+sb.width()+'px;height:'+sb.height()+'px;'+wb+'background-color:'+vb+';"> </div>').insertBefore(sb).css('opacity',l.series.pie.label.background.opacity);}}}}}function la(i){if(l.series.pie.innerRadius>0){i.save();innerRadius=l.series.pie.innerRadius>1?l.series.pie.innerRadius:p*l.series.pie.innerRadius;i.globalCompositeOperation='destination-out';i.beginPath();i.fillStyle=l.series.pie.stroke.color;i.arc(0,0,innerRadius,0,Math.PI*2,false);i.fill();i.closePath();i.restore();i.save();i.beginPath();i.strokeStyle=l.series.pie.stroke.color;i.arc(0,0,innerRadius,0,Math.PI*2,false);i.stroke();i.closePath();i.restore();}}function ma(i,x){for(var y=false,va=-1,wa=i.length,xa=wa-1;++va<wa;xa=va)((i[va][1]<=x[1]&&x[1]<i[xa][1])||(i[xa][1]<=x[1]&&x[1]<i[va][1]))&&(x[0]<(i[xa][0]-i[va][0])*(x[1]-i[va][1])/(i[xa][1]-i[va][1])+i[va][0])&&(y=!y);return y;}function na(i,va){var wa=m.getData(),xa=m.getOptions(),ya=xa.series.pie.radius>1?xa.series.pie.radius:p*xa.series.pie.radius;for(var za=0;za<wa.length;++za){var ab=wa[za];if(ab.pie.show){ctx.save();ctx.beginPath();ctx.moveTo(0,0);ctx.arc(0,0,ya,ab.startAngle,ab.startAngle+ab.angle,false);ctx.closePath();x=i-q;y=va-r;if(ctx.isPointInPath){if(ctx.isPointInPath(i-q,va-r)){ctx.restore();return {datapoint:[ab.percent,ab.data],dataIndex:0,series:ab,seriesIndex:za};}}else{p1X=(ya*Math.cos(ab.startAngle));p1Y=(ya*Math.sin(ab.startAngle));p2X=(ya*Math.cos(ab.startAngle+(ab.angle/4)));p2Y=(ya*Math.sin(ab.startAngle+(ab.angle/4)));p3X=(ya*Math.cos(ab.startAngle+(ab.angle/2)));p3Y=(ya*Math.sin(ab.startAngle+(ab.angle/2)));p4X=(ya*Math.cos(ab.startAngle+(ab.angle/1.5)));p4Y=(ya*Math.sin(ab.startAngle+(ab.angle/1.5)));p5X=(ya*Math.cos(ab.startAngle+ab.angle));p5Y=(ya*Math.sin(ab.startAngle+ab.angle));arrPoly=[[0,0],[p1X,p1Y],[p2X,p2Y],[p3X,p3Y],[p4X,p4Y],[p5X,p5Y]];arrPoint=[x,y];if(ma(arrPoly,arrPoint)){ctx.restore();return {datapoint:[ab.percent,ab.data],dataIndex:0,series:ab,seriesIndex:za};}}ctx.restore();}}return null;}function oa(i){qa('plothover',i);}function pa(i){qa('plotclick',i);}function qa(i,x){var y=m.offset(),va=parseInt(x.pageX-y.left),wa=parseInt(x.pageY-y.top),xa=na(va,wa);if(l.grid.autoHighlight){for(var ya=0;ya<ba.length;++ya){var za=ba[ya];if(za.auto==i&&!(xa&&za.series==xa.series))sa(za.series);}if(xa)ra(xa.series,i);}var ab={pageX:x.pageX,pageY:x.pageY};o.trigger(i,[ab,xa]);}function ra(i,x){if(typeof i=="number")i=series[i];var y=ta(i);if(y==-1){ba.push({series:i,auto:x});m.triggerRedrawOverlay();}else if(!x)ba[y].auto=false;}function sa(i){if(i==null){ba=[];m.triggerRedrawOverlay();}if(typeof i=="number")i=series[i];var x=ta(i);if(x!=-1){ba.splice(x,1);m.triggerRedrawOverlay();}}function ta(i){for(var x=0;x<ba.length;++x){var y=ba[x];if(y.series==i)return x;}return -1;}function ua(x,y){var va=x.getOptions(),wa=va.series.pie.radius>1?va.series.pie.radius:p*va.series.pie.radius;y.save();y.translate(q,r);y.scale(1,va.series.pie.tilt);for(i=0;i<ba.length;++i)xa(ba[i].series);la(y);y.restore();function xa(i){if(i.angle<0)return;y.fillStyle="rgba(255, 255, 255, "+va.series.pie.highlight.opacity+")";y.beginPath();if(Math.abs(i.angle-Math.PI*2)>1e-09)y.moveTo(0,0);y.arc(0,0,wa,i.startAngle,i.startAngle+i.angle,false);y.closePath();y.fill();}}}var l={series:{pie:{show:false,radius:'auto',innerRadius:0,startAngle:3/2,tilt:1,offset:{top:0,left:'auto'},stroke:{color:'#FFF',width:1},label:{show:'auto',formatter:function(i,m){return '<div style="font-size:x-small;text-align:center;padding:2px;color:'+m.color+';">'+i+'<br/>'+Math.round(m.percent)+'%</div>';},radius:1,background:{color:null,opacity:0},threshold:0},combine:{threshold:-1,color:null,label:'Other'},highlight:{opacity:.5}}}};h.plot.plugins.push({init:k,options:l,name:"pie",version:"1.0"});})(g);});
__d("insights-view-graph-styles",["insights-date-utils","insights-constants","insights-number-utils","flot-pie"],function(a,b,c,d,e,f){var g=b('insights-date-utils').DateFormatter,h=b('insights-date-utils').midnightsInRange,i=b('insights-constants').InsightsConstants,j=b('insights-number-utils').NumberFormatter,k={yAxisTicksGenerator:function(t){var u=2;if(t.max>u){var v=j.magnitude(t.max);u=Math.ceil(t.max/Math.pow(10,v))*Math.pow(10,v);}if(u%2==1)u++;return [[0,''],[u/2,j.abbrevInt(u/2)],[u,j.abbrevInt(u)]];},options:function(){return {grid:{borderWidth:1,hoverable:true,autoHighlight:true,mouseActiveRadius:5},yaxis:{min:0,ticks:k.yAxisTicksGenerator},shadowSize:0};}},l={options:function(){return {lines:{show:true,fill:.1}};}},m={options:function(){return {lines:{show:true}};}},n={options:function(){return {points:{show:true,radius:2,fill:true,fillColor:false}};}},o={options:function(){return {bars:{show:true,align:'center',lineWidth:0,fill:true,fillColor:{colors:[{opacity:1}]},barWidth:.75}};}},p={options:function(){b('flot-pie');return {series:{pie:{show:true}}};}},q={options:function(){var t=o.options().bars;t.barWidth=.75*i.MS_PER_DAY;return {bars:t};}},r={tickSize:function(t){return t>i.TICK_SIZE_THRESHOLD?i.TICK_SIZE_LONG:i.TICK_SIZE_SHORT;},xAxisTicksGenerator:function(t){var u=[],v=Math.round((t.max-t.min)/i.MS_PER_DAY)+1,w=r.tickSize(v),x=null,y=h(t.min,t.max);for(var z=0;z<y.length;z++){var aa=new Date(y[z]+i.getPTOffset(y[z])).getUTCDate();if(x==null&&aa%w===0)x=z;if(x!=null&&(z-x)%w===0)u.push(y[z]);}return u;},options:function(){return {xaxis:{mode:'time',tickFormatter:g.abbrevMonthDateFromTimestamp,ticks:r.xAxisTicksGenerator,tickLength:5}};}},s={frequencyTicksGenerator:function(t){var u=[];for(var v=0;v<i.FrequencyBuckets.length;v++)u.push([v,i.FrequencyBuckets[v]]);return u;},options:function(){return {xaxis:{ticks:s.frequencyTicksGenerator,min:-.5,tickLength:0,max:i.FrequencyBuckets.length}};}};f.BaseGraph=k;f.AreaGraph=l;f.LineGraph=m;f.BarGraph=o;f.PointGraph=n;f.PieChart=p;f.TimeSeries=r;f.TimeSeriesBarGraph=q;f.ReachFrequencyGraph=s;});
__d("insights-view-graph-utils",["uki-utils","insights-number-utils","insights-date-utils","insights-constants","tx"],function(a,b,c,d,e,f){var g=b('uki-utils'),h=b('insights-number-utils').NumberFormatter,i=b('insights-date-utils').DateFormatter,j=b('insights-constants').InsightsConstants,k=b('tx');TooltipFormatters={main:function(l){var m=this._getItemSeriesIndex(l),n=l.datapoint[0],o=m===0?l.datapoint[1]:this.series()[m][l.dataIndex][1],p=h.integer(o);if(m===0){return (p==1?"1 publication":k._("{num} publications",{num:p}))+'<br/>'+i.shortDate(new Date(n));}else if(m==1){return TooltipFormatters.formatPTAT(n,p);}else if(m==2){return TooltipFormatters.formatReach(n,p);}else return null;},reachAndPTAT:function(l){var m=this._getItemSeriesIndex(l),n=l.datapoint[0],o=this.series()[m][l.dataIndex][1],p=h.integer(o);if(m===0){return TooltipFormatters.formatPTAT(n,p);}else if(m===1)return TooltipFormatters.formatReach(n,p);return null;},formatPTAT:function(l,m){return (m==1?"1 personne en parle":k._("{num} personnes en parlent",{num:m}))+'<br/>'+i.weekRangeString(l);},formatReach:function(l,m){return (m==1?"1 personne atteinte":k._("{num} personnes atteintes",{num:m}))+'<br/>'+i.weekRangeString(l);},likes:function(l){var m=this.getOriginalSeriesIndex(l.seriesIndex),n=i.shortDate(new Date(l.datapoint[0])),o=h.integer(l.datapoint[1]);if(m===0){return (o==1?"1 nouvelle mention J\u2019aime":k._("{num} nouvelles mentions J\u2019aime",{num:o}))+'<br/>'+n;}else if(m==1){return (o==1?"1 annulation de mention J\u2019aime":k._("{num} annulations de mention J\u2019aime",{num:o}))+'<br/>'+n;}else return null;},reach:function(l){var m=this._reachGraph.getOriginalSeriesIndex(l.seriesIndex),n=this._reachGraph._metrics[m].label;return TooltipFormatters.peopleTip(l,' ('+n+')');},reachFrequency:function(l){var m=j.FrequencyBuckets[l.datapoint[0]],n=h.integer(l.datapoint[1]),o;if(n==1){if(m==1){o="1 personne atteinte une fois";}else o=k._("1 personne atteinte {freq} fois",{freq:m});}else if(m==1){o=k._("{num} personnes atteintes une fois",{num:n});}else o=k._("{num} personnes atteintes {freq} fois",{num:n,freq:m});return o+'<br/>'+i.weekRangeString(this.frequencyBreakdownDate());},pageViews:function(l){var m=this.getOriginalSeriesIndex(l.seriesIndex),n=i.shortDate(new Date(l.datapoint[0])),o=h.integer(l.datapoint[1]);if(m===0){return (o==1?"1 affichage de Page":k._("{num} affichages de Page",{num:o}))+'<br/>'+n;}else if(m==1){return (o==1?"1 affichage unique de Page":k._("{num} affichages uniques de Page",{num:o}))+'<br/>'+n;}else return null;},talking:function(l){return TooltipFormatters.peopleTip(l);},viralReach:function(l){return TooltipFormatters.peopleTip(l);},peopleTip:function(l,m){var n=h.integer(l.datapoint[1]),o=n==1?"1 personne":k._("{num} personnes",{num:n});return o+(m||'')+'<br/>'+i.weekRangeString(l.datapoint[0]);},checkinsType:function(l){var m=h.integer(l.datapoint[1]);return (m==1?"1 visite":k._("{num} visites",{num:m}))+'<br/>'+i.weekRangeString(l.datapoint[0]);}};f.TooltipFormatters=TooltipFormatters;});
__d("insights-view-hoverable-graph",["uki-dom","uki-function","uki-view","uki-builder","uki-utils","uki-env","uki-view-container","uki-fb-view-text","DoNotUseJQuery17","insights-view-base-graph"],function(a,b,c,d,e,f){var g=b('uki-dom'),h=b('uki-function'),i=b('uki-view'),j=b('uki-builder').build,k=b('uki-utils'),l=b('uki-env').doc,m=b('uki-view-container').Container,n=b('uki-fb-view-text').Text,o=b('DoNotUseJQuery17'),p=b('insights-view-base-graph').BaseGraph,q=i.newClass('insights.HoverableGraph',p,{tooltipFormatter:h.newProp('tooltipFormatter',function(r){this._tooltipFormatter=h.bind(r,this);this._listenToPlotHover();}),_listenToPlotHover:function(){o(this.dom()).bind('plothover',h.bind(this._onHover,this));},_onHover:function(r,s,t){var u=o('.graphTooltip');if(t){if(!u||this._previousSeriesIndex!=this._getItemSeriesIndex(t)||this._previousDataIndex!=t.dataIndex){this._previousSeriesIndex=this._getItemSeriesIndex(t);this._previousDataIndex=t.dataIndex;u.remove();this._showTooltip(t,s);}}else{u.remove();this._previousSeriesIndex=null;this._previousDataIndex=null;}},_showTooltip:function(r,s){var t=this.tooltipFormatter()(r),u=this._tooltipCoords(r,s),v=j([{view:m,className:'graphTooltip',childViews:[{view:m,init:{tagName:'span'},as:'text',addClass:'graphTooltipText',html:t}],style:{top:u.y+'px',left:u.x+'px'}}]);l.body.appendChild(v.dom());},_tooltipCoords:function(r,s){return {x:r.pageX?r.pageX+10:s.pageX+1,y:r.pageY?r.pageY-20:s.pageY+1};},_getItemSeriesIndex:function(r){return r.series.seriesIndex||r.seriesIndex;}});f.HoverableGraph=q;});
__d("insights-view-graph-with-legend",["uki-function","uki-dom","uki-view","uki-builder","uki-utils","uki-view-container","insights-view-hoverable-graph"],function(a,b,c,d,e,f){var g=b('uki-function'),h=b('uki-dom'),i=b('uki-view'),j=b('uki-builder').build,k=b('uki-utils'),l=b('uki-view-container').Container,m=b('insights-view-hoverable-graph').HoverableGraph,n=i.newClass('insights.GraphWithLegend',l,{_createDom:function(o){this._dom=h.createElement('div');var p=j([{view:l,addClass:'graph-legend',as:'legend'},{view:o.baseGraph||m,as:'graph'}]);p.appendTo(this);this._legendView=p.view('legend');this._graphView=p.view('graph');this._graphView.legendContainer(this._legendView);},plot:g.newDelegateCall('_graphView','plot'),graphView:function(){return this._graphView;}});g.delegateProp(n.prototype,['colors','legend','series','mixins','options','addOptions','loading','noColumnsLegend','legendStyle','tooltipFormatter','maxPoints'],'_graphView');f.GraphWithLegend=n;});
/**
 * @providesModule flot-stack
 * @option preserve-header
 *
 * Copyright (c) 2007-2009 IOLA and Ole Laursen
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use,
 * copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following
 * conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
 * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 * OTHER DEALINGS IN THE SOFTWARE.
 *
 * Flot plugin for stacking data sets, i.e. putting them on top of each
 * other, for accumulative graphs.
 *
 * The plugin assumes the data is sorted on x (or y if stacking
 * horizontally). For line charts, it is assumed that if a line has an
 * undefined gap (from a null point), then the line above it should have
 * the same gap - insert zeros instead of "null" if you want another
 * behaviour. This also holds for the start and end of the chart. Note
 * that stacking a mix of positive and negative values in most instances
 * doesn't make sense (so it looks weird).
 *
 * Two or more series are stacked when their "stack" attribute is set to
 * the same key (which can be any number or string or just "true"). To
 * specify the default stack, you can set
 *
 *   series: {
 *     stack: null or true or key (number/string)
 *   }
 *
 * or specify it for a specific series
 *
 *   $.plot($("#placeholder"), [{ data: [ ... ], stack: true }])
 *
 * The stacking order is determined by the order of the data series in
 * the array (later series end up on top of the previous).
 *
 * Internally, the plugin modifies the datapoints in each series, adding
 * an offset to the y value. For line series, extra data points are
 * inserted through interpolation. If there's a second y value, it's also
 * adjusted (e.g for bar charts or filled areas).
 */__d("flot-stack",["flot"],function(a,b,c,d,e,f){var g=b('flot');(function(){var h={series:{stack:null}};function i(j){function k(m,n){var o=null;for(var p=0;p<n.length;++p){if(m==n[p])break;if(n[p].stack==m.stack)o=n[p];}return o;}function l(n,o,p){if(o.stack==null)return;var q=k(o,n.getData());if(!q)return;var r=p.pointsize,s=p.points,t=q.datapoints.pointsize,u=q.datapoints.points,v=[],w,x,y,z,aa,ba,ca=o.lines.show,da=o.bars.horizontal,ea=r>2&&(da?p.format[2].x:p.format[2].y),fa=ca&&o.lines.steps,ga=true,ha=da?1:0,ia=da?0:1,ja=0,ka=0,la;while(true){if(ja>=s.length)break;la=v.length;if(s[ja]==null){for(m=0;m<r;++m)v.push(s[ja+m]);ja+=r;}else if(ka>=u.length){if(!ca)for(m=0;m<r;++m)v.push(s[ja+m]);ja+=r;}else if(u[ka]==null){for(m=0;m<r;++m)v.push(null);ga=true;ka+=t;}else{w=s[ja+ha];x=s[ja+ia];z=u[ka+ha];aa=u[ka+ia];ba=0;if(w==z){for(m=0;m<r;++m)v.push(s[ja+m]);v[la+ia]+=aa;ba=aa;ja+=r;ka+=t;}else if(w>z){if(ca&&ja>0&&s[ja-r]!=null){y=x+(s[ja-r+ia]-x)*(z-w)/(s[ja-r+ha]-w);v.push(z);v.push(y+aa);for(m=2;m<r;++m)v.push(s[ja+m]);ba=aa;}ka+=t;}else{if(ga&&ca){ja+=r;continue;}for(m=0;m<r;++m)v.push(s[ja+m]);if(ca&&ka>0&&u[ka-t]!=null)ba=aa+(u[ka-t+ia]-aa)*(w-z)/(u[ka-t+ha]-z);v[la+ia]+=ba;ja+=r;}ga=false;if(la!=v.length&&ea)v[la+2]+=ba;}if(fa&&la!=v.length&&la>0&&v[la]!=null&&v[la]!=v[la-r]&&v[la+1]!=v[la-r+1]){for(m=0;m<r;++m)v[la+r+m]=v[la+m];v[la+1]=v[la-r+1];}}p.points=v;}j.hooks.processDatapoints.push(l);}g.plot.plugins.push({init:i,options:h,name:'stack',version:'1.2'});})();});
/**
 * @providesModule flot-bubble
 * @option preserve-header
 *
 * Copyright (c) 2007-2009 IOLA and Ole Laursen
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use,
 * copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following
 * conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
 * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 * OTHER DEALINGS IN THE SOFTWARE.
 *
 * Flot plugin for bubble charting
 *
 * To activate bubbles:
 *
 * plot = $.plot($("#placeholder"), [
 * // data needs to be in the form [x,y,z] where z is the radius of the point
 * { data: [[1,2,10],[4,6,8],[3,1,4]], color: '#A1FDFF', label: 'boom' }
 * ],
 * {
 *   series: {
 *     bubble: true, // set this to true to activate bubbles, otherwise your data will be plotted as points
 *     points: { show: true }, // bubbles will only work with point charts, the plugin will NOT attempt to bubble a bar chart
 *     lines:  { show: true } // the bubble plugin supports connecting bubbles in a series with lines
 *   },
 * }
 * );
 */__d("flot-bubble",["DoNotUseJQuery17","flot"],function(a,b,c,d,e,f){var g=b('DoNotUseJQuery17'),h=b('flot');(function(i){var j={series:{bubble:null}};function k(l){function m(){if(window.console)bagofholding.apply(console,arguments);}function n(fa,ga){function ha(na,oa,pa,qa,ra,sa,ta,ua){var va=na.points,wa=na.pointsize;for(var xa=0;xa<va.length;xa+=wa){var ya=va[xa],za=va[xa+1];if(ya==null||ya<sa.min||ya>sa.max||za<ta.min||za>ta.max)continue;var ab=xa/2,oa=ua[ab][2];ga.beginPath();var bb=l.getOptions();if(bb.series.bubble_options&&bb.series.bubble_options.occupancy){ga.arc(sa.p2c(ya),ta.p2c(za)+(bb.series.bubble_options.radius_offset-oa),oa,0,ra,false);}else ga.arc(sa.p2c(ya),ta.p2c(za)+qa,oa,0,ra,false);if(pa){ga.fillStyle=pa;ga.fill();}ga.stroke();}}ga.save();var ia=l.getPlotOffset();ga.translate(ia.left,ia.top);var ja=fa.lines.lineWidth,ka=fa.shadowSize,la=fa.points.radius;if(ja>0&&ka>0){var ma=ka/2;ga.lineWidth=ma;ga.strokeStyle="rgba(0,0,0,0.1)";ha(fa.datapoints,la,null,ma+ma/2,Math.PI,fa.xaxis,fa.yaxis,fa.data);ga.strokeStyle="rgba(0,0,0,0.2)";ha(fa.datapoints,la,null,ma/2,Math.PI,fa.xaxis,fa.yaxis,fa.data);}ga.lineWidth=ja;ga.strokeStyle=fa.color;ha(fa.datapoints,la,o(fa.points,fa.color),0,2*Math.PI,fa.xaxis,fa.yaxis,fa.data);ga.restore();}function o(fa,ga,ha,ia){var ja=fa.fill;if(!ja)return null;if(fa.fillColor)return p(ga,ha,ia,ga);var ka=i.color.parse(ga);ka.a=typeof ja=="number"?ja:.4;ka.normalize();return ka.toString();}function p(fa,ga,ha,ia){if(typeof fa=="string"){return fa;}else{var ja=ctx.createLinearGradient(0,ha,0,ga);for(var ka=0,la=fa.colors.length;ka<la;++ka){var ma=fa.colors[ka];if(typeof ma!="string"){var na=i.color.parse(ia);if(ma.brightness!=null)na=na.scale('rgb',ma.brightness);if(ma.opacity!=null)na.a*=ma.opacity;ma=na.toString();}ja.addColorStop(ka/(la-1),ma);}return ja;}}var q=[];function r(fa){t("plothover",fa,function(ga){return ga.hoverable!=false;});}function s(fa){t("plotclick",fa,function(ga){return ga.clickable!=false;});}function t(fa,event,ga){var ha=l.bubble.eventHolder.offset(),ia=event.pageX-ha.left-l.getPlotOffset().left,ja=event.pageY-ha.top-l.getPlotOffset().top,ka=l.c2p({left:ia,top:ja});ka.pageX=event.pageX;ka.pageY=event.pageY;var la=u(ia,ja,ga);if(la){la.pageX=parseInt(la.series.xaxis.p2c(la.datapoint[0])+ha.left+l.getPlotOffset().left);la.pageY=parseInt(la.series.yaxis.p2c(la.datapoint[1])+ha.top+l.getPlotOffset().top);}if(l.getOptions().grid.autoHighlight){for(var ma=0;ma<q.length;++ma){var na=q[ma];if(na.auto==fa&&!(la&&na.series==la.series&&na.point==la.datapoint))w(na.series,na.point);}if(la)v(la.series,la.datapoint,fa);}l.getPlaceholder().trigger(fa,[ka,la]);}function u(fa,ga,ha){var ia=l.getOptions().grid.mouseActiveRadius,ja=ia*ia+1,ka=null,la=false,ma,na,oa=l.getData();for(ma=oa.length-1;ma>=0;--ma){if(!ha(oa[ma]))continue;var pa=oa[ma],qa=pa.xaxis,ra=pa.yaxis,sa=pa.datapoints.points,ta=pa.datapoints.pointsize,ua=qa.c2p(fa),va=ra.c2p(ga);if(pa.lines.show||pa.points.show)for(na=0;na<sa.length;na+=ta){var wa=sa[na],xa=sa[na+1];if(wa==null)continue;var ya=aa(pa,[wa,xa]),za=ya*ya+1,ab=ya/qa.scale,bb=ya/ra.scale;if(wa-ua>ab||wa-ua<-ab||xa-va>bb||xa-va<-bb)continue;var cb=Math.abs(qa.p2c(wa)-fa),db=Math.abs(ra.p2c(xa)-ga),eb=cb*cb+db*db;if(eb<za){za=eb;ka=[ma,na/ta];}}if(pa.bars.show&&!ka){var fb=pa.bars.align=="left"?0:-pa.bars.barWidth/2,gb=fb+pa.bars.barWidth;for(na=0;na<sa.length;na+=ta){var wa=sa[na],xa=sa[na+1],hb=sa[na+2];if(wa==null)continue;if(oa[ma].bars.horizontal?(ua<=Math.max(hb,wa)&&ua>=Math.min(hb,wa)&&va>=xa+fb&&va<=xa+gb):(ua>=wa+fb&&ua<=wa+gb&&va>=Math.min(hb,xa)&&va<=Math.max(hb,xa)))ka=[ma,na/ta];}}}if(ka){ma=ka[0];na=ka[1];var ta=oa[ma].datapoints.pointsize;return {datapoint:oa[ma].datapoints.points.slice(na*ta,(na+1)*ta),dataIndex:na,series:oa[ma],seriesIndex:ma};}return null;}function v(fa,ga,ha){if(typeof fa=="number")fa=series[fa];if(typeof ga=="number")ga=fa.data[ga];var ia=x(fa,ga);if(ia==-1){q.push({series:fa,point:ga,auto:ha});l.triggerRedrawOverlay();}else if(!ha)q[ia].auto=false;}function w(fa,ga){if(fa==null&&ga==null){q=[];triggerRedrawOverlay();}if(typeof fa=="number")fa=series[fa];if(typeof ga=="number")ga=fa.data[ga];var ha=x(fa,ga);if(ha!=-1){q.splice(ha,1);l.triggerRedrawOverlay();}}function x(fa,ga){for(var ha=0;ha<q.length;++ha){var ia=q[ha];if(ia.series==fa&&ia.point[0]==ga[0]&&ia.point[1]==ga[1])return ha;}return -1;}function y(fa,ga){var ha=ga[0],ia=ga[1],ja=fa.xaxis,ka=fa.yaxis;if(ha<ja.min||ha>ja.max||ia<ka.min||ia>ka.max)return;var la=l.bubble.octx,ma=aa(fa,ga),na=ma+fa.points.lineWidth/2,oa=l.getPlotOffset();la.lineWidth=fa.points.lineWidth*5.5;la.strokeStyle=i.color.parse(fa.color).scale('a',.4).toString();la.beginPath();la.arc(ja.p2c(ha)+oa.left,ka.p2c(ia)+oa.top,na,0,2*Math.PI,false);la.stroke();}function z(fa,ga){var ha=fa[ga];if(!ha||ha==1)return axes[ga];if(typeof ha=="number")return axes[ga.charAt(0)+ha+ga.slice(1)];return ha;}function aa(fa,ga){var ha=fa.datapoints.points,ia=fa.datapoints.pointsize;for(var ja=ha.length;ja>1;ja-=ia){var ka=ha[ja-2],la=ha[ja-1];if(ga[0]==ka&&ga[1]==la){var ma=(ja-2)/2;return fa.data[ma][2];}}return 0;}function ba(fa,ga){fa.bubble.eventHolder=ga;var ha=fa.getOptions();if(ca()&&ha.grid.hoverable)ga.unbind('mousemove').mousemove(r);if(ha.series.bubble&&ha.grid.clickable)ga.unbind('click').click(s);}function ca(){return !!l.getOptions().series.bubble&&!!l.getOptions().series.points.show;}function da(fa,ga){var ha=fa.getData();i.each(ha,function(ia,ja){if(ja.bubble)n(ja,ga);});}function ea(fa,ga){fa.bubble.octx=ga;i.each(q,function(ha,ia){y(ia.series,ia.point);});}l.bubble={eventHolder:null,octx:null};l.hooks.bindEvents.push(ba);l.hooks.draw.push(da);l.hooks.drawOverlay.push(ea);}h.plot.plugins.push({init:k,options:j,name:'bubble',version:'0.1'});})(g);});
__d("insights-main-graph",["uki-function","uki-dom","uki-view","uki-builder","uki-utils","flot-stack","flot-bubble","insights-constants","insights-view-graph-styles","insights-view-graph-utils","insights-view-graph-with-legend","insights-view-hoverable-graph"],function(a,b,c,d,e,f){var g=b('uki-function'),h=b('uki-dom'),i=b('uki-view'),j=b('uki-builder').build,k=b('uki-utils'),l=b('flot-stack'),m=b('flot-bubble'),n=b('insights-constants').InsightsConstants.Events,o=b('insights-view-graph-styles'),p=b('insights-view-graph-utils'),q=b('insights-view-graph-with-legend').GraphWithLegend,r=b('insights-view-hoverable-graph').HoverableGraph,s=b('insights-constants').InsightsConstants,t=.5,u=.75,v=5,w=2,x=10,y=1.2,z=i.newClass('insights.Graph',r,{showPoints:g.newProp('showPoints'),_showPoints:true,showBubbles:g.newProp('showBubbles'),_showBubbles:true,bubbleMaxSize:g.newProp('bubbleMaxSize'),_bubbleMaxSize:x,bubbleMinSize:g.newProp('bubbleMinSize'),_bubbleMinSize:v,bubbleIncrement:g.newProp('bubbleIncrement'),_bubbleIncrement:w,_layout:function(){this.on(n.Plotted,g.bind(function(){var aa=this.series&&this.series()[0];aa.length&&this.trigger({type:n.Ready});},this));},_stackInsights:function(aa,ba){this._maxScaledReach=0;var ca=0;for(var da=0;da<ba.length;da++){var ea=Math.pow(ba[da][1],u),fa=Math.pow(aa[da][1],u);this._maxScaledReach=Math.max(this._maxScaledReach,ea);if(ea>0)ca=Math.max(ca,fa/ea);}var ga=ca===0?1:t/ca,ha=[],ia=[],ja=Math.min(aa.length,ba.length);for(da=0;da<ja;da++){var ka=ba[da][1]===0?0:Math.pow(aa[da][1],u)*ga;ha.push([aa[da][0],ka]);ia.push([ba[da][0],Math.pow(ba[da][1],u)-ha[da][1]]);}var la=this.showPoints()?o.PointGraph.options().points:{};return [{data:ha,stack:true,yaxis:1,points:la},{data:ia,stack:true,yaxis:2,points:la}];},_bubbleSize:function(aa){return Math.min(this.bubbleMinSize()+this.bubbleIncrement()*(aa-1),this.bubbleMaxSize());},_makeBubbleSeries:function(aa,ba){var ca=[],da=Math.min(ba,aa.length);for(var ea=0;ea<da;ea++)if(aa[ea][1]>0){ca.push([aa[ea][0],aa[ea][1],this._bubbleSize(aa[ea][1])]);continue;}return {data:ca,bubble:true,points:{show:true},lines:{show:false},yaxis:3};},_yaxes:function(){var aa={tickLength:0,ticks:[],min:0,max:this._maxScaledReach*y,labelWidth:this.bubbleMaxSize()/2},ba=k.extend({},aa,{position:'right'}),ca={show:false,min:0,max:s.MAX_INT};return [aa,ba,ca];},_flotData:function(){var aa=k.toArray(this.series()),ba=this.showBubbles()?3:2;if(!aa||aa.length!=ba)return null;var ca=[];if(this.showBubbles()){var da=aa.shift(),ea=Math.min.apply(null,k.map(aa,function(ia){return ia.length;}));ca=[this._makeBubbleSeries(da,ea)];}var fa=aa.shift(),ga=aa.shift();ca=ca.concat(this._stackInsights(fa,ga));for(var ha=0;ha<ca.length;ha++){ca[ha].label=this._chooseLabel(ha);ca[ha].color=this._chooseColor(ha);}return ca;},_flotOptions:function(){var aa=r.prototype._flotOptions.call(this);return k.extend(aa,{yaxes:this._yaxes()});}});f.InsightsMainGraph=z;});
__d("PostInsightsFlyout",["event-extensions","AsyncRequest","copyProperties","HoverFlyout"],function(a,b,c,d,e,f){b('event-extensions');var g=b('AsyncRequest'),h=b('copyProperties'),i=b('HoverFlyout'),j={},k=200;function l(m,n,o){this._pageID=m;this._postID=n;this._node=o;this._pending=false;this._mouseOn=false;this._flyout=null;this._mouseEnterListener=Event.listen(this._node,'mouseenter',this._fetchFlyout.bind(this));this._mouseLeaveListener=Event.listen(this._node,'mouseleave',this._onMouseLeave.bind(this));j[this._postID]=this;}h(l,{setFlyout:function(m,n){this._pending=false;var o=j[m];o&&o.onFlyoutSet(n);}});h(l.prototype,{_fetchFlyout:function(){this._mouseOn=true;if(this._pending||this._flyout)return;this._pending=true;var m={context_id:this._node.id,page_id:this._pageID,post_id:this._postID};new g().setURI('/insights/ajax/post_insights_widget.php').setData(m).send();},_onMouseLeave:function(){this._mouseOn=false;},onFlyoutSet:function(m){if(!this._flyout){this._mouseEnterListener&&this._mouseEnterListener.remove();this._mouseLeaveListener&&this._mouseLeaveListener.remove();this._flyout=new i(m,this._node,k,k);if(this._mouseOn)this._flyout.showFlyout(this._node,true);}}});e.exports=l;});
function FansJewel(){}copyProperties(FansJewel.prototype,{init:function(a){this.jewel=a;this.jewel.subscribe('marked-seen',this._markSeenCallback.shield(this));},_markSeenCallback:function(a,b){new AsyncRequest('/ajax/pages/fans_seen.php').setMethod('POST').send();}});
__d("Messaging",["AsyncRequest","DOM","Env","HTML","MercuryEmoji","MessagingEvents","URI","createArrayFrom"],function(a,b,c,d,e,f){var g=b('AsyncRequest'),h=b('DOM'),i=b('Env'),j=b('HTML'),k=b('MercuryEmoji'),l=b('MessagingEvents'),m=b('URI'),n=b('createArrayFrom');function o(q,r){if(!h.isTextNode(q)){var s=n(q.childNodes);for(var t=0;t<s.length;t++)o(s[t],r);return;}var u=q.nodeValue;if(r)u=q.nodeValue.replace(/\n/g,' ');var v=k.htmlEmojiAndEmote(u);if(!v||v==q.nodeValue)return;var w=j(v).getNodes();if(!w||!w.length)return;for(var x=w.length;x--;)h.insertAfter(q,w[x]);h.remove(q);}var p={getUserThreadURI:function(q){return m(i.www_base).setPath('/messages/'+q);},getInboxThreadURI:function(q){return m(i.www_base).setPath('/messages/?action=read&tid='+q);},markAsRead:function(q){q=n(q);new g().setURI('/ajax/messaging/async.php').setData({action:'markRead',tids:q}).setMethod('POST').setHandler(bagofholding).setErrorHandler(bagofholding).send();l.inform('mark-as-read',{tids:q});},markUserThreadAsRead:function(q){new g().setURI('/ajax/messaging/async.php').setData({action:'chatMarkRead',other_user:q}).setMethod('POST').setHandler(bagofholding).setErrorHandler(bagofholding).send();l.inform('mark-as-read',{chat_ids:[q]});},unsubscribeFromThread:function(q){new g().setURI('/ajax/messaging/async.php').setData({action:'unsubscribe',tids:q}).setMethod('POST').setHandler(bagofholding).setErrorHandler(bagofholding).send();},emojiAndEmoteContent:function(q,r){for(var s=0;s<q.length;s++)o(q[s],r);}};e.exports=p;});
__d("legacy:Messaging",["Messaging"],function(a,b,c,d){a.Messaging=b('Messaging');},3);
function fbpage_set_fan_status(a,b,c,d,e,f,g){e=e?e:function(j){_fbpage_show_change_status_feedback(a,j.getPayload());};var h={fbpage_id:b,add:c,reload:d};if(g!=null)copyProperties(h,g);var i=new AsyncRequest().setURI('/ajax/pages/fan_status.php').setData(h).setNectarModuleDataSafe(a).setHandler(e);if(f)i.setErrorHandler(f);i.send();return false;}function fbpage_set_favorite_status(a,b,c){var d=function(){_fbpage_show_change_status_feedback(a,this.getUserData());},e={fbpage_id:b,add:c},f=new AsyncRequest().setMethod('POST').setURI('/ajax/pages/favorite_status.php').setData(e);new Dialog().setAsync(f).setCloseHandler(d).show();return false;}function _fbpage_show_change_status_feedback(a,b){if(!b||!a)return;if(b.reload){fbpage_reload_on_fan_status_changed(b.preserve_tab);}else fbpage_redraw_on_fan_status_changed(a,b.feedback);}function fbpage_reload_on_fan_status_changed(a){var b=URI.getRequestURI();if(a){var c=FutureSideNav.getInstance().selected.textKey;if(!b.getQueryData().sk&&c)b.addQueryData({sk:c});}window.location.href=b;}function fbpage_redraw_on_fan_status_changed(a,b){if(!b)return;if(Parent.byClass(a,'fbTimelineEscapeSectionItem'))a=Parent.byClass(a,'fan_status_inactive')||a;var c=DOM.create('span',{className:'fan_status_inactive'},b);a.parentNode.replaceChild(c,a);var d=function(){if(data.can_repeat_action)c.parentNode.replaceChild(a,c);};animation(c).duration(3000).checkpoint().to('backgroundColor','#FFFFFF').duration(1000).ondone(d).go();}function fbpage_toggle_like_on_fan_status_changed(a,b){var c=$('liked_pages_like_action_'+a),d=$('liked_pages_undo_action_'+a);CSS.conditionClass(c,'hidden_elem',b);CSS.conditionClass(d,'hidden_elem',!b);}
__d("legacy:LayerHideOnEscape",["LayerHideOnEscape"],function(a,b,c,d){a.LayerHideOnEscape=b('LayerHideOnEscape');},3);
function Tour(){if(Tour._instance)Tour._instance.setTourComplete();Tour._instance=this;}copyProperties(Tour.prototype,{tourStarted:false,tourComplete:false,_navigationBeginToken:null,_pageLeaveToken:null,steps:{},openDialog:null,init:function(){this._pageLeaveToken=Arbiter.subscribe('onload/exit',this.handleLeavePage.bind(this));this._navigationBeginToken=Arbiter.subscribe(NavigationMessage.NAVIGATION_BEGIN,this.handleTransition.bind(this));this.steps={};return this;},registerStep:function(a,b){a.disableBehavior(LayerDestroyOnHide);a.disableBehavior(LayerHideOnEscape);this.steps[b]=a;a.subscribe('show',function(){a.inform('tour-dialog-show',a);});if(!this.getTourStarted())this.setTourStart();},_unsubscribeSubscriptions:function(){this._navigationBeginToken.unsubscribe();this._pageLeaveToken.unsubscribe();},handleLeavePage:function(){this._unsubscribeSubscriptions();},handleTransition:function(){this._unsubscribeSubscriptions();},handleTourStart:function(){},handleTourStop:function(){},handleTourComplete:function(){},showStep:function(a){var b=this.steps[a];if(!(this.openDialog==b))this.hideOpenDialog();if(!b)return;this.openDialog=b;b.show();},hideOpenDialog:function(){if(this.openDialog){this.openDialog.hide();this.openDialog=null;}},getTourStarted:function(){return this.tourStarted;},setTourStart:function(){this.tourStarted=true;this.handleTourStart();},setTourStop:function(){this.tourStarted=false;this.hideOpenDialog();this.handleTourStop();},setTourComplete:function(){if(this.tourComplete)return;this.setTourStop();this.tourComplete=true;this.handleTourComplete();},hideStep:function(a){var b=this.steps[a];b&&b.hide();}});copyProperties(Tour,{getInstance:function(){return Tour._instance||(Tour._instance=new Tour());}});
var PageLikeButton=window.PageLikeButton||(function(){function a(c,d,e,f,g){Tour.getInstance().hideStep('low_page_likes');fbpage_set_fan_status(c,d,e,false,function(){Arbiter.inform(PageLikeButton.LIKED_SUCCESS,{profile_id:d});},f,{fan_origin:g});}function b(c,d,event){a(event.getTarget(),c,true,function(e){Arbiter.inform(PageLikeButton.UNLIKED,{profile_id:c});AsyncResponse.defaultErrorHandler(e);},d);Arbiter.inform(PageLikeButton.LIKED,{profile_id:c});Arbiter.inform(SubscribeButton.SUBSCRIBED,{profile_id:c});}return {LIKED:'liked',UNLIKED:'unliked',LIKED_SUCCESS:'liked_success',init:function(c,d,e,f,g,h){Arbiter.subscribe(PageLikeButton.LIKED,function(i,j){if(f===j.profile_id)c.swap();});Arbiter.subscribe(PageLikeButton.UNLIKED,function(i,j){if(f===j.profile_id){c.unswap();e.hideFlyout();}});if(h)Arbiter.subscribe(PageLikeButton.LIKED_SUCCESS,function(i,j){app_data=URI.getRequestURI().getQueryData().app_data;if(j.profile_id==f)new AsyncRequest().setURI('/ajax/pages/fetch_app_column.php').setData({profile_id:f,tab_key:h,app_data:app_data}).send();});Event.listen(d,'click',bind(this,b,f,g));},initCallout:function(c,d){callout=document.getElementById('pageActionLikeCalloutButton');Event.listen(callout,'click',bind(this,b,c,d));},initUnlike:function(c,d,e){Event.listen(c,'click',function(event){a(event.getTarget(),d,false,function(f){Arbiter.inform(PageLikeButton.LIKED,{profile_id:d});AsyncResponse.defaultErrorHandler(f);},e);Arbiter.inform.bind(Arbiter,PageLikeButton.UNLIKED,{profile_id:d}).defer();Arbiter.inform.bind(Arbiter,SubscribeButton.UNSUBSCRIBED,{profile_id:d}).defer();});}};})();
__d("AdminPanelInsights",["uki-builder","uki-utils","ge","insights-constants","insights-view-graph-styles","insights-view-graph-utils","insights-view-graph-with-legend","insights-main-graph","insights-date-utils","AsyncRequest"],function(a,b,c,d,e,f){var g=b('uki-builder').build,h=b('uki-utils'),i=b('ge'),j=b('insights-constants').InsightsConstants,k=b('insights-view-graph-styles'),l=b('insights-view-graph-utils').TooltipFormatters,m=b('insights-view-graph-with-legend').GraphWithLegend,n=b('insights-main-graph').InsightsMainGraph,o=b('insights-date-utils').midnightsInRange,p=b('AsyncRequest'),q=[j.ColorsMap.magenta,j.ColorsMap.green,j.ColorsMap.blue],r={options:function(){return {grid:h.extend(k.BaseGraph.options().grid,{minBorderMargin:8}),xaxis:{ticks:[]}};}},s={fetchData:function(t){new p().setURI('/ajax/timeline/pages/admin_panel_insights.php').setData({profile_id:t}).setHandler(this.plotGraph).send();},plotGraph:function(t){var u=t.getPayload(),v=u.post_counts,w=u.talking,x=u.reach,y=u.show_bubbles,z=u.legend,aa=u.container_id,ba=[v,w,x],ca=l.main;if(!y){q.shift();z.shift();ba.shift();ca=l.reachAndPTAT;}var da=g({view:m,init:{baseGraph:n},as:'graph',mixins:[k.BaseGraph,k.TimeSeries,k.AreaGraph,r],colors:q,legend:z,tooltipFormatter:ca}),ea=i(aa);da.attach(ea);var fa=da.view('graph');if(u.page_insights_url)fa.on('click',function(){window.open(u.page_insights_url,'_blank');});var ga=fa.graphView();ga.showBubbles(y);ga.showPoints(false);ga.bubbleMinSize(2);ga.bubbleMaxSize(5);ga.bubbleIncrement(1);ga.plot(ba);ga.loading(false);}};e.exports=s;});
__d("PagesAnchorDialogEnforcer",["array-extensions","event-extensions","AsyncRequest","copyProperties","DOM","URI"],function(a,b,c,d,e,f){b('array-extensions');b('event-extensions');var g=b('AsyncRequest'),h=b('copyProperties'),i=b('DOM'),j=b('URI'),k={LOCATION_COMPOSER:1,LOCATION_MILESTONE:2,LOCATION_SPINE:3,LOCATION_EDIT_MENU:4,LOCATION_HIDE_JOINED:5},l=[];function m(r,s,t){var u=i.find(document,r);n(u,s,t);}function n(r,s,t){l.push(Event.listen(r,'click',function(u){new g().setURI('/ajax/timeline/pages/anchor_dialog.php').setData({profile_id:s,location:t}).send();return false;},Event.Priority.URGENT));}function o(r,s){p();switch(s){case k.LOCATION_COMPOSER:case k.LOCATION_MILESTONE:case k.LOCATION_SPINE:case k.LOCATION_EDIT_MENU:case k.LOCATION_HIDE_JOINED:j.getRequestURI().go();break;default:}}function p(){l.forEach(function(r){r.remove();});l=[];}var q={enforceDialogOnNode:n,enforceDialogOnSelector:m,onSuccessForLocation:o};e.exports=q;});
var PlaceActionLink={start_claim_link:function(a){var b=new AsyncRequest().setMethod('POST').setURI('/ajax/places/claim/start_claim.php').setData({id:a});new Dialog().setAsync(b).show();return false;},refer_claim_link:function(a){var b=new AsyncRequest().setMethod('POST').setURI('/ajax/places/claim/refer_claim.php').setData({id:a});new Dialog().setAsync(b).show();return false;}};
var FBXLoadMoreExperiences={reveal:function(a,b){var c=a.offsetHeight;b=DOM.replace(a,b)[0];animation(b).from('height',c).to('height','auto').duration(400).blind().ease(animation.ease.both).go();}};
var TimelineAggregatePost={init:function(a){Event.listen(a,'click',function(b){var c=b.getModifiers();if(b.isMiddleClick()||c.access||c.meta)return true;var d=Parent.byTag(b.getTarget(),'li');if(!CSS.hasClass(d,"-cx-PRIVATE-fbTimelineWallPostUnit__pager"))new AsyncRequest().setURI(DataStore.get(d,'url')).send();});},initPage:function(a){Event.listen(a,'click',function(b){var c=Parent.byClass(b.getTarget(),'uiCloseButton');if(c)return;var d=Parent.byTag(b.getTarget(),'li');new AsyncRequest().setURI(DataStore.get(d,'url')).send();});},poke:function(a){ScrollableArea.poke(a);},setScrollHeight:function(a){var b=DOM.find(a,'.sArea');Style.set(b,'height',a.offsetHeight+'px');}};
__d("legacy:TimelineStickyHeader",["TimelineStickyHeader"],function(a,b,c,d){a.TimelineStickyHeader=b('TimelineStickyHeader');},3);
__d("TimelinePageMostRecent",["CSS","DOMQuery","Parent","Style","TimelineCapsule","$"],function(a,b,c,d,e,f){var g=b('CSS'),h=b('DOMQuery'),i=b('Parent'),j=b('Style'),k=b('TimelineCapsule'),l=b('$'),m={init:function(n,o){if(!g.shown(n)){g.show(n);var p=l(o);j.set(h.find(p,'div.sArea'),'height',(p.offsetHeight||0)+'px');k.balanceCapsule(i.byClass(l(n),'fbTimelineCapsule'));}}};e.exports=m;});
function PagesTimelineScrubber(a){this.parent.construct(this,a);}Class.extend(PagesTimelineScrubber,'TimelineMainScrubber');copyProperties(PagesTimelineScrubber,{PANEL_BODY_HEIGHT:430,ANIMATION_TIME_MS:250});PagesTimelineScrubber.show=function(a,b){if(ge('admin_panel')&&CSS.shown('admin_panel_body')){DOMScroll.scrollTo($('admin_panel'),true);return;}var c=$('admin_panel'),d=$('admin_panel_body');CSS.show(d);CSS.hide('adminPanelShowButton');CSS.show('adminPanelHideButton');if(b){d.style.height=PagesTimelineScrubber.PANEL_BODY_HEIGHT+'px';}else{d.style.height=0;animation(d).to('height',PagesTimelineScrubber.PANEL_BODY_HEIGHT).duration(PagesTimelineScrubber.ANIMATION_TIME_MS).go();DOMScroll.scrollTo(c,true);}new AsyncRequest('/ajax/pages/admin_panel/collapse.php').setData({pid:a,collapsed:false,in_tour:b}).setMethod('POST').send();};PagesTimelineScrubber.hide=function(a,b){if(ge('admin_panel')&&!CSS.shown('admin_panel_body'))return;var c=$('admin_panel_body');CSS.show('adminPanelShowButton');CSS.hide('adminPanelHideButton');if(b){c.style.height=0;CSS.hide(c);}else animation(c).to('height',0).hide().duration(PagesTimelineScrubber.ANIMATION_TIME_MS).go();new AsyncRequest('/ajax/pages/admin_panel/collapse.php').setData({pid:a,collapsed:true,in_tour:b}).setMethod('POST').send();};